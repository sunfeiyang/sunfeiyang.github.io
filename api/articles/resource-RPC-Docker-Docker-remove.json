{"title":"docker-修改容器的挂载目录三种方式","num_read":1296,"num_like":955,"num_collection":646,"num_comments":178,"slug":"resource-RPC-Docker-Docker-remove","date":"2021-03-02T16:00:00.000Z","img":"/img/header_img/docker/docker.jpg","_id":"clhrbp2fm00efo5lg0g5rg3fj","project":"RPC","site":{"data":{}},"updated":"2022-01-12T06:06:40.000Z","author":"Sunfy","comments":true,"path":"api/articles/resource-RPC-Docker-Docker-remove.json","webPath":"2021/03/03/resource-RPC-Docker-Docker-remove/","permalink":"https://sunfy9.gitee.io/2021/03/03/resource-RPC-Docker-Docker-remove/","excerpt":"docker-修改容器的挂载目录三种方式","covers":null,"keywords":"sunfy, hexo-theme-snail","content":"<p>docker-修改容器的挂载目录三种方式<a id=\"more\"></a></p>\n<h3 id=\"方式一：修改配置文件\"><a href=\"#方式一：修改配置文件\" class=\"headerlink\" title=\"方式一：修改配置文件\"></a>方式一：修改配置文件</h3><p>（需停止docker服务）<br>1、停止docker服务<br>systemctl stop docker.service（关键，修改之前必须停止docker服务）<br>2、vim /var/lib/docker/containers/container-ID/config.v2.json<br>修改配置文件中的目录位置，然后保存退出</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"MountPoints\":&#123;\"/home\":&#123;\"Source\":\"/docker\",\"Destination\":\"/home\",\"RW\":true,\"Name\":\"\",\"Driver\":\"\",\"Type\":\"bind\",\"Propagation\":\"rprivate\",\"Spec\":&#123;\"Type\":\"bind\",\"Source\":\"//docker/\",\"Target\":\"/home\"&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>3、启动docker服务<br>systemctl start docker.service<br>4、启动docker容器<br>docker start <container-name/ID></p>\n<h3 id=\"方式二：提交现有容器为新镜像，然后重新运行它\"><a href=\"#方式二：提交现有容器为新镜像，然后重新运行它\" class=\"headerlink\" title=\"方式二：提交现有容器为新镜像，然后重新运行它\"></a>方式二：提交现有容器为新镜像，然后重新运行它<sunfy-line></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> docker ps  -a</span></span><br><span class=\"line\">CONTAINER ID        IMAGE                 COMMAND                  CREATED              STATUS                          PORTS               NAMES</span><br><span class=\"line\">   5a3422adeead        ubuntu:14.04          \"/bin/bash\"              About a minute ago   Exited (0) About a minute ago                       agitated_newton</span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> docker commit 5a3422adeead newimagename</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> docker run -ti -v <span class=\"string\">\"<span class=\"variable\">$PWD</span>/dir1\"</span>:/dir1 -v <span class=\"string\">\"<span class=\"variable\">$PWD</span>/dir2\"</span>:/dir2 newimagename /bin/bash</span></span><br></pre></td></tr></table></figure>\n<p>然后停止旧容器，并使用这个新容器，如果由于某种原因需要新容器使用旧名称，请在删除旧容器后使用docker rename。</p>\n<h3 id=\"方式三：export容器为镜像，然后import为新镜像\"><a href=\"#方式三：export容器为镜像，然后import为新镜像\" class=\"headerlink\" title=\"方式三：export容器为镜像，然后import为新镜像\"></a>方式三：export容器为镜像，然后import为新镜像</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">docker container <span class=\"built_in\">export</span> -o ./myimage.docker 容器ID</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">docker import ./myimage.docker newimagename</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">docker run -ti -v <span class=\"string\">\"<span class=\"variable\">$PWD</span>/dir1\"</span>:/dir1 -v <span class=\"string\">\"<span class=\"variable\">$PWD</span>/dir2\"</span>:/dir2 newimagename /bin/bash</span></span><br></pre></td></tr></table></figure>\n<p>然后停止旧容器，并使用这个新容器，如果由于某种原因需要新容器使用旧名称，请在删除旧容器后使用docker rename。</p>\n","more":"</p>\n<h3 id=\"方式一：修改配置文件\"><a href=\"#方式一：修改配置文件\" class=\"headerlink\" title=\"方式一：修改配置文件\"></a>方式一：修改配置文件</h3><p>（需停止docker服务）<br>1、停止docker服务<br>systemctl stop docker.service（关键，修改之前必须停止docker服务）<br>2、vim /var/lib/docker/containers/container-ID/config.v2.json<br>修改配置文件中的目录位置，然后保存退出</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">\"MountPoints\":&#123;\"/home\":&#123;\"Source\":\"/docker\",\"Destination\":\"/home\",\"RW\":true,\"Name\":\"\",\"Driver\":\"\",\"Type\":\"bind\",\"Propagation\":\"rprivate\",\"Spec\":&#123;\"Type\":\"bind\",\"Source\":\"//docker/\",\"Target\":\"/home\"&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>\n<p>3、启动docker服务<br>systemctl start docker.service<br>4、启动docker容器<br>docker start <container-name/ID></p>\n<h3 id=\"方式二：提交现有容器为新镜像，然后重新运行它\"><a href=\"#方式二：提交现有容器为新镜像，然后重新运行它\" class=\"headerlink\" title=\"方式二：提交现有容器为新镜像，然后重新运行它\"></a>方式二：提交现有容器为新镜像，然后重新运行它<sunfy-line></h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> docker ps  -a</span></span><br><span class=\"line\">CONTAINER ID        IMAGE                 COMMAND                  CREATED              STATUS                          PORTS               NAMES</span><br><span class=\"line\">   5a3422adeead        ubuntu:14.04          \"/bin/bash\"              About a minute ago   Exited (0) About a minute ago                       agitated_newton</span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> docker commit 5a3422adeead newimagename</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\"> docker run -ti -v <span class=\"string\">\"<span class=\"variable\">$PWD</span>/dir1\"</span>:/dir1 -v <span class=\"string\">\"<span class=\"variable\">$PWD</span>/dir2\"</span>:/dir2 newimagename /bin/bash</span></span><br></pre></td></tr></table></figure>\n<p>然后停止旧容器，并使用这个新容器，如果由于某种原因需要新容器使用旧名称，请在删除旧容器后使用docker rename。</p>\n<h3 id=\"方式三：export容器为镜像，然后import为新镜像\"><a href=\"#方式三：export容器为镜像，然后import为新镜像\" class=\"headerlink\" title=\"方式三：export容器为镜像，然后import为新镜像\"></a>方式三：export容器为镜像，然后import为新镜像</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">docker container <span class=\"built_in\">export</span> -o ./myimage.docker 容器ID</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">docker import ./myimage.docker newimagename</span></span><br><span class=\"line\"><span class=\"meta\">$</span><span class=\"bash\">docker run -ti -v <span class=\"string\">\"<span class=\"variable\">$PWD</span>/dir1\"</span>:/dir1 -v <span class=\"string\">\"<span class=\"variable\">$PWD</span>/dir2\"</span>:/dir2 newimagename /bin/bash</span></span><br></pre></td></tr></table></figure>\n<p>然后停止旧容器，并使用这个新容器，如果由于某种原因需要新容器使用旧名称，请在删除旧容器后使用docker rename。</p>","next":{"title":"Ubuntu桌面被删除后","path":"api/articles/resource-system-Linux-UbuntuAboutDesktop.json","image":"/img/header_img/15.gif","num_read":1357,"num_like":714,"num_collection":584,"num_comments":142},"prev":{"title":"使用maven命令安装指定(第三方)jar包到本地仓库","path":"api/articles/resource-tools-git-maven-mavenInstallJar.json","image":"/img/header_img/16.gif","num_read":1206,"num_like":501,"num_collection":36,"num_comments":178},"categories":[{"name":"RPC远程调用","path":"api/categories/RPC远程调用.json","pathContent":"api/categories/RPC远程调用","description":"RPC（Remote Procedure Call）远程过程调用，简单的理解是一个节点请求另一个节点提供的服务","cover":"https://sunfy9.gitee.io/project/photo/project/rpc.jpg"}],"tags":[{"name":"Docker","path":"api/tags/Docker.json","pathContent":"api/tags/Docker","description":"一个开源的应用容器引擎。","cover":"https://sunfy9.gitee.io/img/header_img/sunfy-default.png"}]}