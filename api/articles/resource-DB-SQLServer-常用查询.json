{"title":"SQLSERVER数据库常用查询","num_read":1389,"num_like":235,"num_collection":810,"num_comments":166,"slug":"resource-DB-SQLServer-常用查询","date":"2022-06-08T16:00:00.000Z","img":"/img/header_img/DB/Commonquery.png","_id":"clhrbp2ax002eo5lggozgg16m","project":"DB","subtitle":"常用查询","hot":"read","site":{"data":{}},"updated":"2022-08-05T04:18:12.000Z","comments":true,"path":"api/articles/resource-DB-SQLServer-常用查询.json","webPath":"2022/06/09/resource-DB-SQLServer-常用查询/","permalink":"https://sunfy9.gitee.io/2022/06/09/resource-DB-SQLServer-%E5%B8%B8%E7%94%A8%E6%9F%A5%E8%AF%A2/","excerpt":null,"covers":null,"keywords":"sunfy, hexo-theme-snail","content":"<h4 id=\"1-死锁相关\"><a href=\"#1-死锁相关\" class=\"headerlink\" title=\"1. 死锁相关\"></a>1. 死锁相关</h4>   <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--查询死锁</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> request_session_id spid,OBJECT_NAME(resource_associated_entity_id)tableName</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> sys.dm_tran_locks</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> resource_type=<span class=\"string\">'OBJECT '</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--杀死死锁</span></span><br><span class=\"line\"><span class=\"keyword\">KILL</span> <span class=\"number\">155</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--显示死锁相关信息</span></span><br><span class=\"line\">exec sp_who2 <span class=\"number\">137</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2-并发线程\"><a href=\"#2-并发线程\" class=\"headerlink\" title=\"2.并发线程\"></a>2.并发线程<sunfy-line></h4>   <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--查询正在使用的并发线程数</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> sysprocesses <span class=\"keyword\">where</span> dbid= db_id(<span class=\"string\">'数据库名'</span>)</span><br></pre></td></tr></table></figure>\n","more":"<h4 id=\"1-死锁相关\"><a href=\"#1-死锁相关\" class=\"headerlink\" title=\"1. 死锁相关\"></a>1. 死锁相关</h4>   <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--查询死锁</span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> request_session_id spid,OBJECT_NAME(resource_associated_entity_id)tableName</span><br><span class=\"line\"><span class=\"keyword\">FROM</span> sys.dm_tran_locks</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> resource_type=<span class=\"string\">'OBJECT '</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--杀死死锁</span></span><br><span class=\"line\"><span class=\"keyword\">KILL</span> <span class=\"number\">155</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">--显示死锁相关信息</span></span><br><span class=\"line\">exec sp_who2 <span class=\"number\">137</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"2-并发线程\"><a href=\"#2-并发线程\" class=\"headerlink\" title=\"2.并发线程\"></a>2.并发线程<sunfy-line></h4>   <figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--查询正在使用的并发线程数</span></span><br><span class=\"line\"><span class=\"keyword\">select</span> * <span class=\"keyword\">from</span> sysprocesses <span class=\"keyword\">where</span> dbid= db_id(<span class=\"string\">'数据库名'</span>)</span><br></pre></td></tr></table></figure>\n","next":{"title":"SQLSERVER数据库触发器","path":"api/articles/resource-DB-SQLServer-触发器.json","image":"/img/header_img/DB/Databasetrigger.png","num_read":808,"num_like":1049,"num_collection":742,"num_comments":56},"prev":{"title":"SQLSERVER数据库索引","path":"api/articles/resource-DB-SQLServer-索引.json","image":"/img/header_img/DB/sqlserverIndex.png","num_read":82,"num_like":449,"num_collection":642,"num_comments":184},"categories":[{"name":"数据库","path":"api/categories/数据库.json","pathContent":"api/categories/数据库","description":"结构化存储格式+事务和并发控制+内存管理+SQL访问接口","cover":"https://sunfy9.gitee.io/project/photo/project/db.jpg"}],"tags":[{"name":"sqlServer","path":"api/tags/sqlServer.json","pathContent":"api/tags/sqlServer","description":"[sqlServer]暂未设置说明","cover":"https://sunfy9.gitee.io/img/header_img/sunfy-default.png"}]}