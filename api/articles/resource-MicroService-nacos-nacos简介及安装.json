{"title":"nacos简介及安装部署","num_read":653,"num_like":408,"num_collection":333,"num_comments":122,"slug":"resource-MicroService-nacos-nacos简介及安装","date":"2021-09-11T16:00:00.000Z","img":"/img/header_img/MicroService/nacos-install.png","minNumber":500,"_id":"clhrbp2dx00bpo5lg19xzhits","project":"MicroService","type":"hot","subtitle":"致力于帮助您发现、配置和管理微服务|帮助您更敏捷和容易地构建、交付和管理微服务平台","hot":"like","site":{"data":{}},"updated":"2022-09-20T01:50:59.586Z","author":"Sunfy","comments":true,"path":"api/articles/resource-MicroService-nacos-nacos简介及安装.json","webPath":"2021/09/12/resource-MicroService-nacos-nacos简介及安装/","permalink":"https://sunfy9.gitee.io/2021/09/12/resource-MicroService-nacos-nacos%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%AE%89%E8%A3%85/","excerpt":null,"covers":["../../../../img/nacos简介及安装/nacosMap.jpg","../../../../img/nacos简介及安装/1533045871534-e64b8031-008c-4dfc-b6e8-12a597a003fb.png","../../../../img/nacos简介及安装/51b1379d727.jpeg","../../../../img/nacos简介及安装/d32859ba997.jpeg","../../../../img/nacos简介及安装/image-20211027120508669.png","../../../../img/nacos简介及安装/de18fac46e1.jpeg","../../../../img/nacos简介及安装/428f6a884f8.jpeg","../../../../img/nacos简介及安装/4b9dccc1961-16353127985884.jpeg"],"keywords":"sunfy, hexo-theme-snail","content":"<h1 id=\"什么是Nacos\"><a href=\"#什么是Nacos\" class=\"headerlink\" title=\"什么是Nacos\"></a>什么是Nacos</h1><p>官网：<a href=\"https://nacos.io/zh-cn/docs/what-is-nacos.html\" target=\"_blank\" rel=\"noopener\">https://nacos.io/zh-cn/docs/what-is-nacos.html</a></p>\n<p><code>Nacos</code> 致力于帮助您发现、配置和管理微服务。<code>Nacos</code> 提供了一组简单易用的特性集，帮助您快速实现动态 服务发现、服务配置、服务元数据及流量管理。</p>\n<p><code>Nacos</code> 帮助您更敏捷和容易地构建、交付和管理微服务平台。 <code>Nacos</code> 是构建以“服务”为中心的现代应用架构 (例如微服务范式、云原生范式) 的服务基础设施。</p>\n<p><code>Nacos</code> 的关键特性:</p>\n<ul>\n<li>服务发现和服务健康监测</li>\n<li>动态配置服务</li>\n<li>动态 <code>DNS</code> 服务</li>\n<li>服务及其元数据管理</li>\n</ul>\n<h2 id=\"Nacos地图\"><a href=\"#Nacos地图\" class=\"headerlink\" title=\"Nacos地图\"></a>Nacos地图</h2><p><img src=\"../../../../img/nacos简介及安装/nacosMap.jpg\" alt=\"nacos_map\"></p>\n<h2 id=\"Nacos生态图\"><a href=\"#Nacos生态图\" class=\"headerlink\" title=\"Nacos生态图\"></a>Nacos生态图</h2><p><img src=\"../../../../img/nacos简介及安装/1533045871534-e64b8031-008c-4dfc-b6e8-12a597a003fb.png\" alt=\"nacos_landscape.png\"></p>\n<p>关于如何在这些生态中使用 <code>Nacos</code>，请参考以下文档：</p>\n<p><a href=\"https://nacos.io/zh-cn/docs/use-nacos-with-springcloud.html\" target=\"_blank\" rel=\"noopener\">Nacos与Spring Cloud一起使用</a></p>\n<p><a href=\"https://nacos.io/zh-cn/docs/use-nacos-with-kubernetes.html\" target=\"_blank\" rel=\"noopener\">Nacos与Kubernetes一起使用</a></p>\n<p><a href=\"https://nacos.io/zh-cn/docs/use-nacos-with-dubbo.html\" target=\"_blank\" rel=\"noopener\">Nacos与Dubbo一起使用</a></p>\n<p><a href=\"https://nacos.io/zh-cn/docs/roadmap.html\" target=\"_blank\" rel=\"noopener\">Nacos与gRPC一起使用</a></p>\n<p><a href=\"https://nacos.io/zh-cn/docs/use-nacos-with-istio.html\" target=\"_blank\" rel=\"noopener\">Nacos与Istio一起使用</a></p>\n<h2 id=\"核心功能\"><a href=\"#核心功能\" class=\"headerlink\" title=\"核心功能\"></a>核心功能<sunfy-line></h2><p><strong>服务注册</strong>：<code>Nacos Client</code>会通过发送REST请求的方式向<code>Nacos Server</code>注册自己的服务，提供自身的元数据，比如<code>ip</code>地址、端口等信息。<code>Nacos Server</code>接收到注册请求后，就会把这些元数据信息存储在一个双层的内存Map中。</p>\n<p><strong>服务心跳</strong>：在服务注册后，<code>Nacos Client</code>会维护一个定时心跳来持续通知<code>Nacos Server</code>，说明服务一直处于可用状态，防止被剔除。默认<code>5s</code>发送一次心跳。</p>\n<p><strong>服务同步</strong>：<code>Nacos Server</code>集群之间会互相同步服务实例，用来保证服务信息的一致性。  leader    raft    </p>\n<p><strong>服务发现</strong>：服务消费者（<code>Nacos Client</code>）在调用服务提供者的服务时，会发送一个REST请求给<code>Nacos Server</code>，获取上面注册的服务清单，并且缓存在<code>Nacos Client</code>本地，同时会在<code>Nacos Client</code>本地开启一个定时任务定时拉取服务端最新的注册表信息更新到本地缓存</p>\n<p><strong>服务健康检查</strong>：<code>Nacos Server</code>会开启一个定时任务用来检查注册服务实例的健康情况，对于超过<code>15s</code>没有收到客户端心跳的实例会将它的healthy属性置为false(客户端服务发现时不会发现)，如果某个实例超过30秒没有收到心跳，直接剔除该实例(被剔除的实例如果恢复发送心跳则会重新注册)</p>\n<p>服务注册表结构</p>\n<p><img src=\"../../../../img/nacos简介及安装/51b1379d727.jpeg\" alt=\"img\"></p>\n<p>服务领域模型</p>\n<p>服务（Service）是 <code>Nacos</code> 世界的一等公民。<code>Nacos</code> 支持几乎所有主流类型的“服务”的发现、配置和管理：</p>\n<p><a href=\"https://kubernetes.io/docs/concepts/services-networking/service/\" target=\"_blank\" rel=\"noopener\">Kubernetes Service</a></p>\n<p><a href=\"https://grpc.io/docs/guides/concepts.html#service-definition\" target=\"_blank\" rel=\"noopener\">gRPC</a> &amp; <a href=\"https://dubbo.incubator.apache.org/\" target=\"_blank\" rel=\"noopener\">Dubbo RPC Service</a></p>\n<p><a href=\"https://spring.io/understanding/REST\" target=\"_blank\" rel=\"noopener\">Spring Cloud RESTful Service</a></p>\n<p><img src=\"../../../../img/nacos简介及安装/d32859ba997.jpeg\" alt=\"img\"></p>\n<h1 id=\"Nacos快速开始\"><a href=\"#Nacos快速开始\" class=\"headerlink\" title=\"Nacos快速开始\"></a>Nacos快速开始</h1><h2 id=\"预备环境准备\"><a href=\"#预备环境准备\" class=\"headerlink\" title=\"预备环境准备\"></a>预备环境准备</h2><p>Nacos 依赖 <a href=\"https://docs.oracle.com/cd/E19182-01/820-7851/inst_cli_jdk_javahome_t/\" target=\"_blank\" rel=\"noopener\">Java</a> 环境来运行。如果您是从代码开始构建并运行Nacos，还需要为此配置 <a href=\"https://maven.apache.org/index.html\" target=\"_blank\" rel=\"noopener\">Maven</a>环境，请确保是在以下版本环境中安装使用:</p>\n<ul>\n<li>64 bit OS，支持 Linux/Unix/Mac/Windows，推荐选用 Linux/Unix/Mac。</li>\n<li>64 bit JDK 1.8+；<a href=\"http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\" target=\"_blank\" rel=\"noopener\">下载</a> &amp; <a href=\"https://docs.oracle.com/cd/E19182-01/820-7851/inst_cli_jdk_javahome_t/\" target=\"_blank\" rel=\"noopener\">配置</a>。</li>\n<li>Maven 3.2.x+；<a href=\"https://maven.apache.org/download.cgi\" target=\"_blank\" rel=\"noopener\">下载</a> &amp; <a href=\"https://maven.apache.org/settings.html\" target=\"_blank\" rel=\"noopener\">配置</a>。</li>\n</ul>\n<h2 id=\"下载源码或者安装包\"><a href=\"#下载源码或者安装包\" class=\"headerlink\" title=\"下载源码或者安装包\"></a>下载源码或者安装包</h2><p>源码下载编译</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/alibaba/nacos.git</span><br><span class=\"line\">cd nacos/</span><br><span class=\"line\">mvn -Prelease-nacos -Dmaven.test.skip=true clean install -U  </span><br><span class=\"line\">ls -al distribution/target/</span><br><span class=\"line\"></span><br><span class=\"line\">// change the $version to your actual path</span><br><span class=\"line\">cd distribution/target/nacos-server-$version/nacos/bin</span><br></pre></td></tr></table></figure>\n<p>或者从 <a href=\"https://github.com/alibaba/nacos/releases\" target=\"_blank\" rel=\"noopener\">最新稳定版本</a> 下载 <code>nacos-server-$version.zip</code> 包。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">unzip nacos-server-$version.zip 或者 tar -xvf nacos-server-$version.tar.gz</span><br><span class=\"line\">cd nacos/bin</span><br></pre></td></tr></table></figure>\n<h2 id=\"启动服务器\"><a href=\"#启动服务器\" class=\"headerlink\" title=\"启动服务器\"></a>启动服务器</h2><h3 id=\"Linux-Unix-Mac\"><a href=\"#Linux-Unix-Mac\" class=\"headerlink\" title=\"Linux/Unix/Mac\"></a>Linux/Unix/Mac</h3><p>启动命令(standalone代表着单机模式运行，非集群模式):</p>\n<p><code>sh startup.sh -m standalone</code></p>\n<p>如果您使用的是<code>ubuntu</code>系统，或者运行脚本报错提示[[符号找不到，可尝试如下运行：</p>\n<p><code>bash startup.sh -m standalone</code></p>\n<h3 id=\"Windows\"><a href=\"#Windows\" class=\"headerlink\" title=\"Windows\"></a>Windows</h3><p>启动命令(standalone代表着单机模式运行，非集群模式):</p>\n<p><code>startup.cmd -m standalone</code></p>\n<p>默认启动方式修改：</p>\n<p><img src=\"../../../../img/nacos简介及安装/image-20211027120508669.png\" alt=\"image-20211027120508669\"></p>\n<h2 id=\"服务注册-amp-发现和配置管理\"><a href=\"#服务注册-amp-发现和配置管理\" class=\"headerlink\" title=\"服务注册&amp;发现和配置管理\"></a>服务注册&amp;发现和配置管理</h2><h3 id=\"服务注册\"><a href=\"#服务注册\" class=\"headerlink\" title=\"服务注册\"></a>服务注册</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X POST &#39;http:&#x2F;&#x2F;127.0.0.1:8848&#x2F;nacos&#x2F;v1&#x2F;ns&#x2F;instance?serviceName&#x3D;nacos.naming.serviceName&amp;ip&#x3D;20.18.7.10&amp;port&#x3D;8080&#39;</span><br></pre></td></tr></table></figure>\n<h3 id=\"服务发现\"><a href=\"#服务发现\" class=\"headerlink\" title=\"服务发现\"></a>服务发现</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X GET &#39;http:&#x2F;&#x2F;127.0.0.1:8848&#x2F;nacos&#x2F;v1&#x2F;ns&#x2F;instance&#x2F;list?serviceName&#x3D;nacos.naming.serviceName&#39;</span><br></pre></td></tr></table></figure>\n<h3 id=\"发布配置\"><a href=\"#发布配置\" class=\"headerlink\" title=\"发布配置\"></a>发布配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X POST &quot;http:&#x2F;&#x2F;127.0.0.1:8848&#x2F;nacos&#x2F;v1&#x2F;cs&#x2F;configs?dataId&#x3D;nacos.cfg.dataId&amp;group&#x3D;test&amp;content&#x3D;HelloWorld&quot;</span><br></pre></td></tr></table></figure>\n<h3 id=\"获取配置\"><a href=\"#获取配置\" class=\"headerlink\" title=\"获取配置\"></a>获取配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X GET &quot;http:&#x2F;&#x2F;127.0.0.1:8848&#x2F;nacos&#x2F;v1&#x2F;cs&#x2F;configs?dataId&#x3D;nacos.cfg.dataId&amp;group&#x3D;test&quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"关闭服务器\"><a href=\"#关闭服务器\" class=\"headerlink\" title=\"关闭服务器\"></a>关闭服务器</h2><h3 id=\"Linux-Unix-Mac-1\"><a href=\"#Linux-Unix-Mac-1\" class=\"headerlink\" title=\"Linux/Unix/Mac\"></a>Linux/Unix/Mac</h3><p><code>sh shutdown.sh</code></p>\n<h3 id=\"Windows-1\"><a href=\"#Windows-1\" class=\"headerlink\" title=\"Windows\"></a>Windows</h3><p><code>shutdown.cmd</code></p>\n<p>或者双击shutdown.cmd运行文件。</p>\n<h2 id=\"集群部署\"><a href=\"#集群部署\" class=\"headerlink\" title=\"集群部署\"></a>集群部署</h2><p>单机搭建伪集群，需要复制nacos安装包，土豪可以直接多个服务器搭建。</p>\n<p>以其中一台服务器为例，做配置说明</p>\n<ul>\n<li>修改<code>conf\\application.properties</code>的配置，使用外置数据源</li>\n</ul>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#使用外置mysql数据源 </span></span><br><span class=\"line\"><span class=\"meta\">spring.datasource.platform</span>=<span class=\"string\">mysql </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### Count of DB:</span></span><br><span class=\"line\"><span class=\"meta\">db.num</span>=<span class=\"string\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### Connect URL of DB:</span></span><br><span class=\"line\"><span class=\"meta\">db.url.0</span>=<span class=\"string\">jdbc:mysql://127.0.0.1:3306/nacos?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC</span></span><br><span class=\"line\"><span class=\"meta\">db.user.0</span>=<span class=\"string\">root</span></span><br><span class=\"line\"><span class=\"meta\">db.password.0</span>=<span class=\"string\">root</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>将<code>conf\\cluster.conf.example</code>改为<code>cluster.conf</code>，添加节点配置</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># ip:port </span><br><span class=\"line\">192.168.3.xx:8848 </span><br><span class=\"line\">192.168.3.xx:88xx </span><br><span class=\"line\">192.168.3.xx:88xx</span><br></pre></td></tr></table></figure>\n<ul>\n<li><p>数据库创建，sql文件在相应的安装包中 <code>conf\\nacos-mysql.sql</code></p>\n</li>\n<li><p>启动脚本可以添加<code>jvm</code>参数</p>\n<p><img src=\"../../../../img/nacos简介及安装/de18fac46e1.jpeg\" alt=\"img\"></p>\n</li>\n<li><p>按照上面的启动方式，分别启动三个nacos</p>\n</li>\n<li><p>测试</p>\n<p>分别登录 <a href=\"http://192.168.3.xx:88xx/nacos，用户名和密码都是nacos\">http://192.168.3.xx:88xx/nacos，用户名和密码都是nacos</a></p>\n</li>\n</ul>\n<p><img src=\"../../../../img/nacos简介及安装/428f6a884f8.jpeg\" alt=\"img\"></p>\n<ul>\n<li>官方推荐，nginx反向代理，修改sever相应的ip和端口即可</li>\n</ul>\n<p><img src=\"../../../../img/nacos简介及安装/4b9dccc1961-16353127985884.jpeg\" alt=\"img\"></p>\n","more":"<h1 id=\"什么是Nacos\"><a href=\"#什么是Nacos\" class=\"headerlink\" title=\"什么是Nacos\"></a>什么是Nacos</h1><p>官网：<a href=\"https://nacos.io/zh-cn/docs/what-is-nacos.html\" target=\"_blank\" rel=\"noopener\">https://nacos.io/zh-cn/docs/what-is-nacos.html</a></p>\n<p><code>Nacos</code> 致力于帮助您发现、配置和管理微服务。<code>Nacos</code> 提供了一组简单易用的特性集，帮助您快速实现动态 服务发现、服务配置、服务元数据及流量管理。</p>\n<p><code>Nacos</code> 帮助您更敏捷和容易地构建、交付和管理微服务平台。 <code>Nacos</code> 是构建以“服务”为中心的现代应用架构 (例如微服务范式、云原生范式) 的服务基础设施。</p>\n<p><code>Nacos</code> 的关键特性:</p>\n<ul>\n<li>服务发现和服务健康监测</li>\n<li>动态配置服务</li>\n<li>动态 <code>DNS</code> 服务</li>\n<li>服务及其元数据管理</li>\n</ul>\n<h2 id=\"Nacos地图\"><a href=\"#Nacos地图\" class=\"headerlink\" title=\"Nacos地图\"></a>Nacos地图</h2><p><img src=\"../../../../img/nacos简介及安装/nacosMap.jpg\" alt=\"nacos_map\"></p>\n<h2 id=\"Nacos生态图\"><a href=\"#Nacos生态图\" class=\"headerlink\" title=\"Nacos生态图\"></a>Nacos生态图</h2><p><img src=\"../../../../img/nacos简介及安装/1533045871534-e64b8031-008c-4dfc-b6e8-12a597a003fb.png\" alt=\"nacos_landscape.png\"></p>\n<p>关于如何在这些生态中使用 <code>Nacos</code>，请参考以下文档：</p>\n<p><a href=\"https://nacos.io/zh-cn/docs/use-nacos-with-springcloud.html\" target=\"_blank\" rel=\"noopener\">Nacos与Spring Cloud一起使用</a></p>\n<p><a href=\"https://nacos.io/zh-cn/docs/use-nacos-with-kubernetes.html\" target=\"_blank\" rel=\"noopener\">Nacos与Kubernetes一起使用</a></p>\n<p><a href=\"https://nacos.io/zh-cn/docs/use-nacos-with-dubbo.html\" target=\"_blank\" rel=\"noopener\">Nacos与Dubbo一起使用</a></p>\n<p><a href=\"https://nacos.io/zh-cn/docs/roadmap.html\" target=\"_blank\" rel=\"noopener\">Nacos与gRPC一起使用</a></p>\n<p><a href=\"https://nacos.io/zh-cn/docs/use-nacos-with-istio.html\" target=\"_blank\" rel=\"noopener\">Nacos与Istio一起使用</a></p>\n<h2 id=\"核心功能\"><a href=\"#核心功能\" class=\"headerlink\" title=\"核心功能\"></a>核心功能<sunfy-line></h2><p><strong>服务注册</strong>：<code>Nacos Client</code>会通过发送REST请求的方式向<code>Nacos Server</code>注册自己的服务，提供自身的元数据，比如<code>ip</code>地址、端口等信息。<code>Nacos Server</code>接收到注册请求后，就会把这些元数据信息存储在一个双层的内存Map中。</p>\n<p><strong>服务心跳</strong>：在服务注册后，<code>Nacos Client</code>会维护一个定时心跳来持续通知<code>Nacos Server</code>，说明服务一直处于可用状态，防止被剔除。默认<code>5s</code>发送一次心跳。</p>\n<p><strong>服务同步</strong>：<code>Nacos Server</code>集群之间会互相同步服务实例，用来保证服务信息的一致性。  leader    raft    </p>\n<p><strong>服务发现</strong>：服务消费者（<code>Nacos Client</code>）在调用服务提供者的服务时，会发送一个REST请求给<code>Nacos Server</code>，获取上面注册的服务清单，并且缓存在<code>Nacos Client</code>本地，同时会在<code>Nacos Client</code>本地开启一个定时任务定时拉取服务端最新的注册表信息更新到本地缓存</p>\n<p><strong>服务健康检查</strong>：<code>Nacos Server</code>会开启一个定时任务用来检查注册服务实例的健康情况，对于超过<code>15s</code>没有收到客户端心跳的实例会将它的healthy属性置为false(客户端服务发现时不会发现)，如果某个实例超过30秒没有收到心跳，直接剔除该实例(被剔除的实例如果恢复发送心跳则会重新注册)</p>\n<p>服务注册表结构</p>\n<p><img src=\"../../../../img/nacos简介及安装/51b1379d727.jpeg\" alt=\"img\"></p>\n<p>服务领域模型</p>\n<p>服务（Service）是 <code>Nacos</code> 世界的一等公民。<code>Nacos</code> 支持几乎所有主流类型的“服务”的发现、配置和管理：</p>\n<p><a href=\"https://kubernetes.io/docs/concepts/services-networking/service/\" target=\"_blank\" rel=\"noopener\">Kubernetes Service</a></p>\n<p><a href=\"https://grpc.io/docs/guides/concepts.html#service-definition\" target=\"_blank\" rel=\"noopener\">gRPC</a> &amp; <a href=\"https://dubbo.incubator.apache.org/\" target=\"_blank\" rel=\"noopener\">Dubbo RPC Service</a></p>\n<p><a href=\"https://spring.io/understanding/REST\" target=\"_blank\" rel=\"noopener\">Spring Cloud RESTful Service</a></p>\n<p><img src=\"../../../../img/nacos简介及安装/d32859ba997.jpeg\" alt=\"img\"></p>\n<h1 id=\"Nacos快速开始\"><a href=\"#Nacos快速开始\" class=\"headerlink\" title=\"Nacos快速开始\"></a>Nacos快速开始</h1><h2 id=\"预备环境准备\"><a href=\"#预备环境准备\" class=\"headerlink\" title=\"预备环境准备\"></a>预备环境准备</h2><p>Nacos 依赖 <a href=\"https://docs.oracle.com/cd/E19182-01/820-7851/inst_cli_jdk_javahome_t/\" target=\"_blank\" rel=\"noopener\">Java</a> 环境来运行。如果您是从代码开始构建并运行Nacos，还需要为此配置 <a href=\"https://maven.apache.org/index.html\" target=\"_blank\" rel=\"noopener\">Maven</a>环境，请确保是在以下版本环境中安装使用:</p>\n<ul>\n<li>64 bit OS，支持 Linux/Unix/Mac/Windows，推荐选用 Linux/Unix/Mac。</li>\n<li>64 bit JDK 1.8+；<a href=\"http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\" target=\"_blank\" rel=\"noopener\">下载</a> &amp; <a href=\"https://docs.oracle.com/cd/E19182-01/820-7851/inst_cli_jdk_javahome_t/\" target=\"_blank\" rel=\"noopener\">配置</a>。</li>\n<li>Maven 3.2.x+；<a href=\"https://maven.apache.org/download.cgi\" target=\"_blank\" rel=\"noopener\">下载</a> &amp; <a href=\"https://maven.apache.org/settings.html\" target=\"_blank\" rel=\"noopener\">配置</a>。</li>\n</ul>\n<h2 id=\"下载源码或者安装包\"><a href=\"#下载源码或者安装包\" class=\"headerlink\" title=\"下载源码或者安装包\"></a>下载源码或者安装包</h2><p>源码下载编译</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/alibaba/nacos.git</span><br><span class=\"line\">cd nacos/</span><br><span class=\"line\">mvn -Prelease-nacos -Dmaven.test.skip=true clean install -U  </span><br><span class=\"line\">ls -al distribution/target/</span><br><span class=\"line\"></span><br><span class=\"line\">// change the $version to your actual path</span><br><span class=\"line\">cd distribution/target/nacos-server-$version/nacos/bin</span><br></pre></td></tr></table></figure>\n<p>或者从 <a href=\"https://github.com/alibaba/nacos/releases\" target=\"_blank\" rel=\"noopener\">最新稳定版本</a> 下载 <code>nacos-server-$version.zip</code> 包。</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">unzip nacos-server-$version.zip 或者 tar -xvf nacos-server-$version.tar.gz</span><br><span class=\"line\">cd nacos/bin</span><br></pre></td></tr></table></figure>\n<h2 id=\"启动服务器\"><a href=\"#启动服务器\" class=\"headerlink\" title=\"启动服务器\"></a>启动服务器</h2><h3 id=\"Linux-Unix-Mac\"><a href=\"#Linux-Unix-Mac\" class=\"headerlink\" title=\"Linux/Unix/Mac\"></a>Linux/Unix/Mac</h3><p>启动命令(standalone代表着单机模式运行，非集群模式):</p>\n<p><code>sh startup.sh -m standalone</code></p>\n<p>如果您使用的是<code>ubuntu</code>系统，或者运行脚本报错提示[[符号找不到，可尝试如下运行：</p>\n<p><code>bash startup.sh -m standalone</code></p>\n<h3 id=\"Windows\"><a href=\"#Windows\" class=\"headerlink\" title=\"Windows\"></a>Windows</h3><p>启动命令(standalone代表着单机模式运行，非集群模式):</p>\n<p><code>startup.cmd -m standalone</code></p>\n<p>默认启动方式修改：</p>\n<p><img src=\"../../../../img/nacos简介及安装/image-20211027120508669.png\" alt=\"image-20211027120508669\"></p>\n<h2 id=\"服务注册-amp-发现和配置管理\"><a href=\"#服务注册-amp-发现和配置管理\" class=\"headerlink\" title=\"服务注册&amp;发现和配置管理\"></a>服务注册&amp;发现和配置管理</h2><h3 id=\"服务注册\"><a href=\"#服务注册\" class=\"headerlink\" title=\"服务注册\"></a>服务注册</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X POST &#39;http:&#x2F;&#x2F;127.0.0.1:8848&#x2F;nacos&#x2F;v1&#x2F;ns&#x2F;instance?serviceName&#x3D;nacos.naming.serviceName&amp;ip&#x3D;20.18.7.10&amp;port&#x3D;8080&#39;</span><br></pre></td></tr></table></figure>\n<h3 id=\"服务发现\"><a href=\"#服务发现\" class=\"headerlink\" title=\"服务发现\"></a>服务发现</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X GET &#39;http:&#x2F;&#x2F;127.0.0.1:8848&#x2F;nacos&#x2F;v1&#x2F;ns&#x2F;instance&#x2F;list?serviceName&#x3D;nacos.naming.serviceName&#39;</span><br></pre></td></tr></table></figure>\n<h3 id=\"发布配置\"><a href=\"#发布配置\" class=\"headerlink\" title=\"发布配置\"></a>发布配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X POST &quot;http:&#x2F;&#x2F;127.0.0.1:8848&#x2F;nacos&#x2F;v1&#x2F;cs&#x2F;configs?dataId&#x3D;nacos.cfg.dataId&amp;group&#x3D;test&amp;content&#x3D;HelloWorld&quot;</span><br></pre></td></tr></table></figure>\n<h3 id=\"获取配置\"><a href=\"#获取配置\" class=\"headerlink\" title=\"获取配置\"></a>获取配置</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl -X GET &quot;http:&#x2F;&#x2F;127.0.0.1:8848&#x2F;nacos&#x2F;v1&#x2F;cs&#x2F;configs?dataId&#x3D;nacos.cfg.dataId&amp;group&#x3D;test&quot;</span><br></pre></td></tr></table></figure>\n<h2 id=\"关闭服务器\"><a href=\"#关闭服务器\" class=\"headerlink\" title=\"关闭服务器\"></a>关闭服务器</h2><h3 id=\"Linux-Unix-Mac-1\"><a href=\"#Linux-Unix-Mac-1\" class=\"headerlink\" title=\"Linux/Unix/Mac\"></a>Linux/Unix/Mac</h3><p><code>sh shutdown.sh</code></p>\n<h3 id=\"Windows-1\"><a href=\"#Windows-1\" class=\"headerlink\" title=\"Windows\"></a>Windows</h3><p><code>shutdown.cmd</code></p>\n<p>或者双击shutdown.cmd运行文件。</p>\n<h2 id=\"集群部署\"><a href=\"#集群部署\" class=\"headerlink\" title=\"集群部署\"></a>集群部署</h2><p>单机搭建伪集群，需要复制nacos安装包，土豪可以直接多个服务器搭建。</p>\n<p>以其中一台服务器为例，做配置说明</p>\n<ul>\n<li>修改<code>conf\\application.properties</code>的配置，使用外置数据源</li>\n</ul>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#使用外置mysql数据源 </span></span><br><span class=\"line\"><span class=\"meta\">spring.datasource.platform</span>=<span class=\"string\">mysql </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### Count of DB:</span></span><br><span class=\"line\"><span class=\"meta\">db.num</span>=<span class=\"string\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">### Connect URL of DB:</span></span><br><span class=\"line\"><span class=\"meta\">db.url.0</span>=<span class=\"string\">jdbc:mysql://127.0.0.1:3306/nacos?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC</span></span><br><span class=\"line\"><span class=\"meta\">db.user.0</span>=<span class=\"string\">root</span></span><br><span class=\"line\"><span class=\"meta\">db.password.0</span>=<span class=\"string\">root</span></span><br></pre></td></tr></table></figure>\n<ul>\n<li>将<code>conf\\cluster.conf.example</code>改为<code>cluster.conf</code>，添加节点配置</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># ip:port </span><br><span class=\"line\">192.168.3.xx:8848 </span><br><span class=\"line\">192.168.3.xx:88xx </span><br><span class=\"line\">192.168.3.xx:88xx</span><br></pre></td></tr></table></figure>\n<ul>\n<li><p>数据库创建，sql文件在相应的安装包中 <code>conf\\nacos-mysql.sql</code></p>\n</li>\n<li><p>启动脚本可以添加<code>jvm</code>参数</p>\n<p><img src=\"../../../../img/nacos简介及安装/de18fac46e1.jpeg\" alt=\"img\"></p>\n</li>\n<li><p>按照上面的启动方式，分别启动三个nacos</p>\n</li>\n<li><p>测试</p>\n<p>分别登录 <a href=\"http://192.168.3.xx:88xx/nacos，用户名和密码都是nacos\">http://192.168.3.xx:88xx/nacos，用户名和密码都是nacos</a></p>\n</li>\n</ul>\n<p><img src=\"../../../../img/nacos简介及安装/428f6a884f8.jpeg\" alt=\"img\"></p>\n<ul>\n<li>官方推荐，nginx反向代理，修改sever相应的ip和端口即可</li>\n</ul>\n<p><img src=\"../../../../img/nacos简介及安装/4b9dccc1961-16353127985884.jpeg\" alt=\"img\"></p>\n","next":{"title":"SpringBean的生命周期详解","path":"api/articles/resource-Spring-Spring-SpringBean的生命周期详解.json","image":"/img/header_img/spring/BeanLife.png","num_read":338,"num_like":573,"num_collection":398,"num_comments":34},"prev":{"title":"Spring依赖注入方式和源码分析","path":"api/articles/resource-Spring-Spring-Spring依赖注入方式和源码分析.json","image":"/img/header_img/spring/DependencyInjection.png","num_read":1802,"num_like":103,"num_collection":106,"num_comments":170},"categories":[{"name":"微服务","path":"api/categories/微服务.json","pathContent":"api/categories/微服务","description":"一种云原生框架方法，其中单个应用程序由许多松散耦合且可独立部署的较小组件或服务组成","cover":"https://sunfy9.gitee.io/project/photo/project/MicroService.PNG"}],"tags":[{"name":"nacos","path":"api/tags/nacos.json","pathContent":"api/tags/nacos","description":"[nacos]暂未设置说明","cover":"https://sunfy9.gitee.io/img/header_img/sunfy-default.png"}]}