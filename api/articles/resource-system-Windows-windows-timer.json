{"title":"Windows服务器定时任务执行","num_read":970,"num_like":207,"num_collection":613,"num_comments":58,"slug":"resource-system-Windows-windows-timer","date":"2021-04-22T16:00:00.000Z","img":"/img/header_img/windows/timer1.gif","_id":"clhrbp2ga00kdo5lg4j5z33wd","site":{"data":{}},"updated":"2022-09-20T02:31:22.506Z","author":"Sunfy","comments":true,"path":"api/articles/resource-system-Windows-windows-timer.json","webPath":"2021/04/23/resource-system-Windows-windows-timer/","permalink":"https://sunfy9.gitee.io/2021/04/23/resource-system-Windows-windows-timer/","excerpt":"Windows执行定时任务，可以执行脚本或打开文件，支持定期（每天，每周，每月），或开机执行、登录执行等","covers":["../../../../img/windows-timer/image-20210604103229068.png","../../../../img/windows-timer/image-20210604103338759.png","../../../../img/windows-timer/image-20210604103513314.png","../../../../img/windows-timer/image-20210604103736790.png"],"keywords":"sunfy, hexo-theme-snail","content":"<p>Windows执行定时任务，可以执行脚本或打开文件，支持定期（每天，每周，每月），或开机执行、登录执行等 <a id=\"more\"></a></p>\n<p>文档说明主要为两个方面操作，一种通过windows可视化窗口新增定时任务，一种通过脚本的方式直接新增。</p>\n<h3 id=\"可视化窗口\"><a href=\"#可视化窗口\" class=\"headerlink\" title=\"可视化窗口\"></a>可视化窗口</h3><h4 id=\"打开页面\"><a href=\"#打开页面\" class=\"headerlink\" title=\"打开页面\"></a>打开页面</h4><p>win+R 打开 <code>taskschd.msc</code></p>\n<p>打开如下页面</p>\n<p><img src=\"../../../../img/windows-timer/image-20210604103229068.png\" alt=\"image-20210604103229068\"></p>\n<h4 id=\"创建基本任务\"><a href=\"#创建基本任务\" class=\"headerlink\" title=\"创建基本任务\"></a>创建基本任务</h4><p><img src=\"../../../../img/windows-timer/image-20210604103338759.png\" alt=\"image-20210604103338759\"></p>\n<h4 id=\"创建任务\"><a href=\"#创建任务\" class=\"headerlink\" title=\"创建任务\"></a>创建任务</h4><p>根据页面提示，创建好对应的任务，即可。<sunfy-line></p>\n<p><img src=\"../../../../img/windows-timer/image-20210604103513314.png\" alt=\"image-20210604103513314\"></p>\n<p>查看任务</p>\n<p>在任务计算程序库中既可以查看到当前创建的定时计划，当前任务的下次运行事件，上次运行事件，包括上次运行结果等都可以看到，同时自己也可以手动运行，测试当前任务是否可以正常执行。</p>\n<p><img src=\"../../../../img/windows-timer/image-20210604103736790.png\" alt=\"image-20210604103736790\"></p>\n<h3 id=\"命令行\"><a href=\"#命令行\" class=\"headerlink\" title=\"命令行\"></a>命令行</h3><p>可视化窗口创建任务、执行任务很方便，但如果要同时创建多个项目，此时就需要做很多重复的机械工作了，效率就很慢了。此时我们可以采用cmd命令的方式，执行新增n多个定时任务。执行命令如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">schtasks /create /tn \"cleanwpp\" /tr D:\\clean\\cleanwpp.bat /sc DAILY /st 01:36</span><br></pre></td></tr></table></figure>\n<p>它的意思是，创建了</p>\n<ul>\n<li>一个为“cleanwpp”的每天（DAILY）01:36定时执行任务。</li>\n<li>该任务会执行D:\\clean路径下的cleanwpp.bat脚本。</li>\n</ul>\n<p>复制多条上面的命令，在windows系统中执行命令，则可以创建多个定时任务。</p>\n","more":"</p>\n<p>文档说明主要为两个方面操作，一种通过windows可视化窗口新增定时任务，一种通过脚本的方式直接新增。</p>\n<h3 id=\"可视化窗口\"><a href=\"#可视化窗口\" class=\"headerlink\" title=\"可视化窗口\"></a>可视化窗口</h3><h4 id=\"打开页面\"><a href=\"#打开页面\" class=\"headerlink\" title=\"打开页面\"></a>打开页面</h4><p>win+R 打开 <code>taskschd.msc</code></p>\n<p>打开如下页面</p>\n<p><img src=\"../../../../img/windows-timer/image-20210604103229068.png\" alt=\"image-20210604103229068\"></p>\n<h4 id=\"创建基本任务\"><a href=\"#创建基本任务\" class=\"headerlink\" title=\"创建基本任务\"></a>创建基本任务</h4><p><img src=\"../../../../img/windows-timer/image-20210604103338759.png\" alt=\"image-20210604103338759\"></p>\n<h4 id=\"创建任务\"><a href=\"#创建任务\" class=\"headerlink\" title=\"创建任务\"></a>创建任务</h4><p>根据页面提示，创建好对应的任务，即可。<sunfy-line></p>\n<p><img src=\"../../../../img/windows-timer/image-20210604103513314.png\" alt=\"image-20210604103513314\"></p>\n<p>查看任务</p>\n<p>在任务计算程序库中既可以查看到当前创建的定时计划，当前任务的下次运行事件，上次运行事件，包括上次运行结果等都可以看到，同时自己也可以手动运行，测试当前任务是否可以正常执行。</p>\n<p><img src=\"../../../../img/windows-timer/image-20210604103736790.png\" alt=\"image-20210604103736790\"></p>\n<h3 id=\"命令行\"><a href=\"#命令行\" class=\"headerlink\" title=\"命令行\"></a>命令行</h3><p>可视化窗口创建任务、执行任务很方便，但如果要同时创建多个项目，此时就需要做很多重复的机械工作了，效率就很慢了。此时我们可以采用cmd命令的方式，执行新增n多个定时任务。执行命令如下：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">schtasks /create /tn \"cleanwpp\" /tr D:\\clean\\cleanwpp.bat /sc DAILY /st 01:36</span><br></pre></td></tr></table></figure>\n<p>它的意思是，创建了</p>\n<ul>\n<li>一个为“cleanwpp”的每天（DAILY）01:36定时执行任务。</li>\n<li>该任务会执行D:\\clean路径下的cleanwpp.bat脚本。</li>\n</ul>\n<p>复制多条上面的命令，在windows系统中执行命令，则可以创建多个定时任务。</p>","next":{"title":"MongoDB安装和可视化工具以及数据备份与恢复","path":"api/articles/resource-DB-MongoDB-MongoDB-copy.json","image":"/img/header_img/DB/mongodb.jpg","num_read":474,"num_like":387,"num_collection":546,"num_comments":103},"prev":{"title":"idea利用docker插件打包上传","path":"api/articles/resource-RPC-Docker-dockerBuildFormIdea.json","image":"/img/header_img/17.gif","num_read":1140,"num_like":972,"num_collection":221,"num_comments":134},"categories":[{"name":"操作系统","path":"api/categories/操作系统.json","pathContent":"api/categories/操作系统","description":"包含CentOS、Ubuntu、Windows等相关","cover":"https://sunfy9.gitee.io/img/header_img/sunfy-default.png"}],"tags":[{"name":"windows","path":"api/tags/windows.json","pathContent":"api/tags/windows","description":"[windows]暂未设置说明","cover":"https://sunfy9.gitee.io/img/header_img/sunfy-default.png"}]}