{"title":"tomcat配置日志输出","num_read":154,"num_like":974,"num_collection":568,"num_comments":65,"slug":"resource-tools-Server-Server-tomcat","date":"2020-02-17T16:00:00.000Z","img":"/img/header_img/server/tomcat-log.png","_id":"clhrbp2i500lgo5lgekoye8qi","site":{"data":{}},"updated":"2022-09-20T02:45:12.269Z","comments":true,"path":"api/articles/resource-tools-Server-Server-tomcat.json","webPath":"2020/02/18/resource-tools-Server-Server-tomcat/","permalink":"https://sunfy9.gitee.io/2020/02/18/resource-tools-Server-Server-tomcat/","excerpt":null,"covers":["../../../../img/Server-tomcat/1311254-20180327133134729-510956596.png","../../../../img/Server-tomcat/1311254-20180327133428757-1430997559-163919615813610.png"],"keywords":"sunfy, hexo-theme-snail","content":"<h2 id=\"tomcat配置gc日志输出\"><a href=\"#tomcat配置gc日志输出\" class=\"headerlink\" title=\"tomcat配置gc日志输出\"></a>tomcat配置gc日志输出</h2><p>omcat目录/bin</p>\n<p>找到catalina.sh(这是linux下，window下应该是catalina.bat)</p>\n<p>配置JAVA_OPTS参数，我这里配置的是tomcat目录/log目录下</p>\n<p>JAVA_OPTS= -Xms1024m -Xmx3048m -XX:PermSize=512m -XX:MaxPermSize=1524m -Xss4096K<br>-Xloggc:../logs/tomcat_gc.log</p>\n<h2 id=\"将输出语句打印至tomcat日志文件中\"><a href=\"#将输出语句打印至tomcat日志文件中\" class=\"headerlink\" title=\"将输出语句打印至tomcat日志文件中\"></a>将输出语句打印至tomcat日志文件中</h2><p>tomcat-9.0.0</p>\n<p>将程序中            System.out.println(“——————这是输出语句System.out.println()——————-“);输出到tomcat 的日志文件中</p>\n<p>只需修改tomcat目录中conf-web.xml  中   debug-value   改为1   默认是0</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">servlet</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">servlet-class</span>&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class=\"tag\">&lt;/<span class=\"name\">servlet-class</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>debug<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>listings<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">load-on-startup</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">load-on-startup</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>日志文件位置在 tomcat目录 logs-catalina.out 中</p>\n<p><img src=\"../../../../img/Server-tomcat/1311254-20180327133134729-510956596.png\" alt=\"img\"></p>\n<p>打开看到</p>\n<p><img src=\"../../../../img/Server-tomcat/1311254-20180327133428757-1430997559-163919615813610.png\" alt=\"img\"></p>\n<p>完成后再将默认值改为0 即可</p>\n<h2 id=\"tomcat日志配置（自带log）\"><a href=\"#tomcat日志配置（自带log）\" class=\"headerlink\" title=\"tomcat日志配置（自带log）\"></a>tomcat日志配置（自带log）</h2><p><strong>问题</strong></p>\n<p>tomcat每次启动时，自动在logs目录下生产以下日志文件，且每天都会生成对应日期的一个文件，造成日志文件众多：</p>\n<blockquote>\n<p>​     localhost.2012-07-05.txt</p>\n<p>​     catalina.2012-07-05.txt</p>\n<p>​     manager.2012-07-05.txt</p>\n<p>​     host-manager.2012-07-05.txt</p>\n</blockquote>\n<p><strong>目的</strong></p>\n<p>​     Tomcat以上日志都输出到同一个文件中。</p>\n<p><strong>修改步骤</strong></p>\n<p>​     打开Tomcat目录conf\\logging.properties，修改如下，所有日志输出到tomcat开头的文件中</p>\n<blockquote>\n<p>1catalina.org.apache.juli.FileHandler.level = FINE</p>\n<p>1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs</p>\n<p># 1catalina.org.apache.juli.FileHandler.prefix = catalina.</p>\n<p>1catalina.org.apache.juli.FileHandler.prefix = tomcat.</p>\n<p>2localhost.org.apache.juli.FileHandler.level = FINE</p>\n<p>2localhost.org.apache.juli.FileHandler.directory = ${catalina.base}/logs</p>\n<p># 2localhost.org.apache.juli.FileHandler.prefix = localhost.</p>\n<p>2localhost.org.apache.juli.FileHandler.prefix = tomcat.</p>\n<p>3manager.org.apache.juli.FileHandler.level = FINE</p>\n<p>3manager.org.apache.juli.FileHandler.directory = ${catalina.base}/logs</p>\n<p># 3manager.org.apache.juli.FileHandler.prefix = manager.</p>\n<p>3manager.org.apache.juli.FileHandler.prefix = tomcat.</p>\n<p>4host-manager.org.apache.juli.FileHandler.level = FINE</p>\n<p>4host-manager.org.apache.juli.FileHandler.directory = ${catalina.base}/logs</p>\n<p># 4host-manager.org.apache.juli.FileHandler.prefix = host-manager.</p>\n<p>4host-manager.org.apache.juli.FileHandler.prefix = tomcat.</p>\n</blockquote>\n<h2 id=\"Tomcat日志总结\"><a href=\"#Tomcat日志总结\" class=\"headerlink\" title=\"Tomcat日志总结\"></a><strong>Tomcat日志总结</strong></h2><h3 id=\"Tomcat-日志信息分为两类-：\"><a href=\"#Tomcat-日志信息分为两类-：\" class=\"headerlink\" title=\"Tomcat 日志信息分为两类 ：\"></a><strong>Tomcat 日志信息分为两类</strong> ：</h3><p>一是运行中的日志，它主要记录运行的一些信息，尤其是一些异常错误日志信息 。</p>\n<p>二是访问日志信息，它记录的访问的时间，IP ，访问的资料等相关信息。</p>\n<h3 id=\"访问日志的配置\"><a href=\"#访问日志的配置\" class=\"headerlink\" title=\"访问日志的配置\"></a><strong>访问日志的配置</strong></h3><p>默认 tomcat 不记录访问日志，如下方法可以使 tomcat 记录访问日志</p>\n<p>编辑 ${catalina}/conf/server.xml 文件. 注 :${catalina} 是 tomcat 的安装目录</p>\n<p>把以下的注释 (<!-- -->) 去掉即可。</p>\n <!--\n\n​        <Valve className=\"org.apache.catalina.valves.AccessLogValve\"\n\n​         directory=\"logs\"  prefix=\"localhost_access_log.\" suffix=\".txt\"\n\n​         pattern=\"common\" resolveHosts=\"false\"/>\n\n  -->\n<h3 id=\"配置tomcat-写出更详细的日志\"><a href=\"#配置tomcat-写出更详细的日志\" class=\"headerlink\" title=\"配置tomcat 写出更详细的日志\"></a>配置tomcat 写出更详细的日志</h3><p>通过对 2.1 示例中 pattern 项的修改，可以改变日志输出的内容。</p>\n<p>该项值可以为： common 与 combined ，这两个预先设置好的格式对应的日志输出内容如下：</p>\n<p>common 的值： %h %l %u %t %r %s %b</p>\n<p>combined 的值： %h %l %u %t %r %s %b %{Referer}i %{User-Agent}i</p>\n<p>pattern 也可以根据需要自由组合, 例如 pattern=”%h %l”</p>\n<p>对于各fields字段的含义请参照 :</p>\n<p><a href=\"http://tomcat.apache.org/tomcat-6.0-doc/config/valve.html\" target=\"_blank\" rel=\"noopener\">http://tomcat.apache.org/tomcat-6.0-doc/config/valve.html</a> 中的 Access Log Valve 项</p>\n<h3 id=\"修改Tomcat运行日志的等级\"><a href=\"#修改Tomcat运行日志的等级\" class=\"headerlink\" title=\"修改Tomcat运行日志的等级\"></a><strong>修改Tomcat运行日志的等级</strong></h3><h4 id=\"日志类型与级别\"><a href=\"#日志类型与级别\" class=\"headerlink\" title=\"日志类型与级别\"></a>日志类型与级别</h4><p>Tomcat 日志分为下面５类：</p>\n<blockquote>\n<p>catalina 、 localhost 、 manager 、 admin 、 host-manager</p>\n</blockquote>\n<p>每类日志的级别分为如下 7 种：</p>\n<blockquote>\n<p>SEVERE (highest value) &gt; WARNING &gt; INFO &gt; CONFIG &gt; FINE &gt; FINER &gt; FINEST (lowest value)</p>\n</blockquote>\n<h4 id=\"日志级别的设定方法\"><a href=\"#日志级别的设定方法\" class=\"headerlink\" title=\"日志级别的设定方法\"></a>日志级别的设定方法</h4><p>修改 conf/logging.properties 中的内容，设定某类日志的级别</p>\n<p>示例：</p>\n<blockquote>\n<p>设置 catalina 日志的级别为： FINE</p>\n<p>1catalina.org.apache.juli.FileHandler.level = FINE</p>\n<p>禁用 catalina 日志的输出：</p>\n<p>1catalina.org.apache.juli.FileHandler.level = OFF</p>\n<p>输出 catalina 所有的日志消息均输出：</p>\n<p>1catalina.org.apache.juli.FileHandler.level = ALL</p>\n</blockquote>\n","more":"<h2 id=\"tomcat配置gc日志输出\"><a href=\"#tomcat配置gc日志输出\" class=\"headerlink\" title=\"tomcat配置gc日志输出\"></a>tomcat配置gc日志输出</h2><p>omcat目录/bin</p>\n<p>找到catalina.sh(这是linux下，window下应该是catalina.bat)</p>\n<p>配置JAVA_OPTS参数，我这里配置的是tomcat目录/log目录下</p>\n<p>JAVA_OPTS= -Xms1024m -Xmx3048m -XX:PermSize=512m -XX:MaxPermSize=1524m -Xss4096K<br>-Xloggc:../logs/tomcat_gc.log</p>\n<h2 id=\"将输出语句打印至tomcat日志文件中\"><a href=\"#将输出语句打印至tomcat日志文件中\" class=\"headerlink\" title=\"将输出语句打印至tomcat日志文件中\"></a>将输出语句打印至tomcat日志文件中</h2><p>tomcat-9.0.0</p>\n<p>将程序中            System.out.println(“——————这是输出语句System.out.println()——————-“);输出到tomcat 的日志文件中</p>\n<p>只需修改tomcat目录中conf-web.xml  中   debug-value   改为1   默认是0</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">servlet</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">servlet-name</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">servlet-name</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">servlet-class</span>&gt;</span>org.apache.catalina.servlets.DefaultServlet<span class=\"tag\">&lt;/<span class=\"name\">servlet-class</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>debug<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param-name</span>&gt;</span>listings<span class=\"tag\">&lt;/<span class=\"name\">param-name</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">param-value</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">param-value</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">init-param</span>&gt;</span></span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">load-on-startup</span>&gt;</span>1<span class=\"tag\">&lt;/<span class=\"name\">load-on-startup</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>日志文件位置在 tomcat目录 logs-catalina.out 中</p>\n<p><img src=\"../../../../img/Server-tomcat/1311254-20180327133134729-510956596.png\" alt=\"img\"></p>\n<p>打开看到</p>\n<p><img src=\"../../../../img/Server-tomcat/1311254-20180327133428757-1430997559-163919615813610.png\" alt=\"img\"></p>\n<p>完成后再将默认值改为0 即可</p>\n<h2 id=\"tomcat日志配置（自带log）\"><a href=\"#tomcat日志配置（自带log）\" class=\"headerlink\" title=\"tomcat日志配置（自带log）\"></a>tomcat日志配置（自带log）</h2><p><strong>问题</strong></p>\n<p>tomcat每次启动时，自动在logs目录下生产以下日志文件，且每天都会生成对应日期的一个文件，造成日志文件众多：</p>\n<blockquote>\n<p>​     localhost.2012-07-05.txt</p>\n<p>​     catalina.2012-07-05.txt</p>\n<p>​     manager.2012-07-05.txt</p>\n<p>​     host-manager.2012-07-05.txt</p>\n</blockquote>\n<p><strong>目的</strong></p>\n<p>​     Tomcat以上日志都输出到同一个文件中。</p>\n<p><strong>修改步骤</strong></p>\n<p>​     打开Tomcat目录conf\\logging.properties，修改如下，所有日志输出到tomcat开头的文件中</p>\n<blockquote>\n<p>1catalina.org.apache.juli.FileHandler.level = FINE</p>\n<p>1catalina.org.apache.juli.FileHandler.directory = ${catalina.base}/logs</p>\n<p># 1catalina.org.apache.juli.FileHandler.prefix = catalina.</p>\n<p>1catalina.org.apache.juli.FileHandler.prefix = tomcat.</p>\n<p>2localhost.org.apache.juli.FileHandler.level = FINE</p>\n<p>2localhost.org.apache.juli.FileHandler.directory = ${catalina.base}/logs</p>\n<p># 2localhost.org.apache.juli.FileHandler.prefix = localhost.</p>\n<p>2localhost.org.apache.juli.FileHandler.prefix = tomcat.</p>\n<p>3manager.org.apache.juli.FileHandler.level = FINE</p>\n<p>3manager.org.apache.juli.FileHandler.directory = ${catalina.base}/logs</p>\n<p># 3manager.org.apache.juli.FileHandler.prefix = manager.</p>\n<p>3manager.org.apache.juli.FileHandler.prefix = tomcat.</p>\n<p>4host-manager.org.apache.juli.FileHandler.level = FINE</p>\n<p>4host-manager.org.apache.juli.FileHandler.directory = ${catalina.base}/logs</p>\n<p># 4host-manager.org.apache.juli.FileHandler.prefix = host-manager.</p>\n<p>4host-manager.org.apache.juli.FileHandler.prefix = tomcat.</p>\n</blockquote>\n<h2 id=\"Tomcat日志总结\"><a href=\"#Tomcat日志总结\" class=\"headerlink\" title=\"Tomcat日志总结\"></a><strong>Tomcat日志总结</strong></h2><h3 id=\"Tomcat-日志信息分为两类-：\"><a href=\"#Tomcat-日志信息分为两类-：\" class=\"headerlink\" title=\"Tomcat 日志信息分为两类 ：\"></a><strong>Tomcat 日志信息分为两类</strong> ：</h3><p>一是运行中的日志，它主要记录运行的一些信息，尤其是一些异常错误日志信息 。</p>\n<p>二是访问日志信息，它记录的访问的时间，IP ，访问的资料等相关信息。</p>\n<h3 id=\"访问日志的配置\"><a href=\"#访问日志的配置\" class=\"headerlink\" title=\"访问日志的配置\"></a><strong>访问日志的配置</strong></h3><p>默认 tomcat 不记录访问日志，如下方法可以使 tomcat 记录访问日志</p>\n<p>编辑 ${catalina}/conf/server.xml 文件. 注 :${catalina} 是 tomcat 的安装目录</p>\n<p>把以下的注释 (<!-- -->) 去掉即可。</p>\n <!--\n\n​        <Valve className=\"org.apache.catalina.valves.AccessLogValve\"\n\n​         directory=\"logs\"  prefix=\"localhost_access_log.\" suffix=\".txt\"\n\n​         pattern=\"common\" resolveHosts=\"false\"/>\n\n  -->\n<h3 id=\"配置tomcat-写出更详细的日志\"><a href=\"#配置tomcat-写出更详细的日志\" class=\"headerlink\" title=\"配置tomcat 写出更详细的日志\"></a>配置tomcat 写出更详细的日志</h3><p>通过对 2.1 示例中 pattern 项的修改，可以改变日志输出的内容。</p>\n<p>该项值可以为： common 与 combined ，这两个预先设置好的格式对应的日志输出内容如下：</p>\n<p>common 的值： %h %l %u %t %r %s %b</p>\n<p>combined 的值： %h %l %u %t %r %s %b %{Referer}i %{User-Agent}i</p>\n<p>pattern 也可以根据需要自由组合, 例如 pattern=”%h %l”</p>\n<p>对于各fields字段的含义请参照 :</p>\n<p><a href=\"http://tomcat.apache.org/tomcat-6.0-doc/config/valve.html\" target=\"_blank\" rel=\"noopener\">http://tomcat.apache.org/tomcat-6.0-doc/config/valve.html</a> 中的 Access Log Valve 项</p>\n<h3 id=\"修改Tomcat运行日志的等级\"><a href=\"#修改Tomcat运行日志的等级\" class=\"headerlink\" title=\"修改Tomcat运行日志的等级\"></a><strong>修改Tomcat运行日志的等级</strong></h3><h4 id=\"日志类型与级别\"><a href=\"#日志类型与级别\" class=\"headerlink\" title=\"日志类型与级别\"></a>日志类型与级别</h4><p>Tomcat 日志分为下面５类：</p>\n<blockquote>\n<p>catalina 、 localhost 、 manager 、 admin 、 host-manager</p>\n</blockquote>\n<p>每类日志的级别分为如下 7 种：</p>\n<blockquote>\n<p>SEVERE (highest value) &gt; WARNING &gt; INFO &gt; CONFIG &gt; FINE &gt; FINER &gt; FINEST (lowest value)</p>\n</blockquote>\n<h4 id=\"日志级别的设定方法\"><a href=\"#日志级别的设定方法\" class=\"headerlink\" title=\"日志级别的设定方法\"></a>日志级别的设定方法</h4><p>修改 conf/logging.properties 中的内容，设定某类日志的级别</p>\n<p>示例：</p>\n<blockquote>\n<p>设置 catalina 日志的级别为： FINE</p>\n<p>1catalina.org.apache.juli.FileHandler.level = FINE</p>\n<p>禁用 catalina 日志的输出：</p>\n<p>1catalina.org.apache.juli.FileHandler.level = OFF</p>\n<p>输出 catalina 所有的日志消息均输出：</p>\n<p>1catalina.org.apache.juli.FileHandler.level = ALL</p>\n</blockquote>\n","next":{"title":"IDEA JRebel 破解最简单的使用","path":"api/articles/resource-tools-IDEA-IDEA-JRebel.json","image":"/img/header_img/tools/idea/idea.png","num_read":30,"num_like":592,"num_collection":276,"num_comments":79},"prev":{"title":"前端基础插件","path":"api/articles/resource-desk-npm-前端基础插件.json","image":"/img/header_img/desk/npm.jpg","num_read":243,"num_like":974,"num_collection":349,"num_comments":175},"categories":[{"name":"应用服务器","path":"api/categories/应用服务器.json","pathContent":"api/categories/应用服务器","description":"一种具有一定逻辑关系，在计算机中应用某种存储结构，并且封装了相应操作的数据元素集合。","cover":"https://sunfy9.gitee.io/project/photo/project/server.jpg"}],"tags":[{"name":"Tomcat","path":"api/tags/Tomcat.json","pathContent":"api/tags/Tomcat","description":"[Tomcat]暂未设置说明","cover":"https://sunfy9.gitee.io/img/header_img/sunfy-default.png"}]}