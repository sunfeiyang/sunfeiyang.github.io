{"title":"MySQL微信表情包特殊字符问题","num_read":343,"num_like":867,"num_collection":315,"num_comments":88,"slug":"resource-DB-MySQL-MySQl-wechat","date":"2020-11-22T16:00:00.000Z","img":"/img/header_img/DB/wechat.png","_id":"clhrbp2ar000uo5lg30std08u","project":"DB","subtitle":"在微信登录功能使用MySQL数据库时，存在表情包特殊字符无法写入问题","site":{"data":{}},"updated":"2021-12-11T04:07:54.000Z","comments":true,"path":"api/articles/resource-DB-MySQL-MySQl-wechat.json","webPath":"2020/11/23/resource-DB-MySQL-MySQl-wechat/","permalink":"https://sunfy9.gitee.io/2020/11/23/resource-DB-MySQL-MySQl-wechat/","excerpt":null,"covers":null,"keywords":"sunfy, hexo-theme-snail","content":"<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>微信用户昵称问题存在特殊字符时，无法保存。因为utf8只能保存三个字节，但是微信表情很多都是四个字节，故无法保存。</p>\n<h2 id=\"解决方式\"><a href=\"#解决方式\" class=\"headerlink\" title=\"解决方式\"></a>解决方式</h2><p>将微信字符集由utf8 设置为 utf8mb4</p>\n<h2 id=\"mysql字符集设置\"><a href=\"#mysql字符集设置\" class=\"headerlink\" title=\"mysql字符集设置\"></a>mysql字符集设置</h2><h3 id=\"window\"><a href=\"#window\" class=\"headerlink\" title=\"window\"></a>window</h3><p>此处设置字符集与数据库安装路径不同，注意区别</p>\n<h4 id=\"MySQL5-7修改字符集\"><a href=\"#MySQL5-7修改字符集\" class=\"headerlink\" title=\"MySQL5.7修改字符集\"></a>MySQL5.7修改字符集</h4><p>本人安装的mysql版本是5.7.20，安装好mysql后就要对字符集进行修改了，于是照着网上的大部分教程说的去安装目录找一个my-default.ini文件，然后重命名为my.ini，再对其进修改字符集即可，具体如下：</p>\n<p>1、mysql5.7.20的my.ini文件不在安装目录下，如果你是默认安装mysql的，那么它的my.ini文件在隐藏文件夹C:\\ProgramData\\MySQL\\MySQL Server 5.7下</p>\n<p>2、对my.ini文件进行修改，修改前请备份好一份。</p>\n<blockquote>\n<p>在该my.ini文件下进行配置修改 ：</p>\n<p>[client]<br>default-character-set = utf8</p>\n<p>[mysql]<br><strong>default-character-set = utf8</strong></p>\n<p>[mysqld]<br>character-set-client-handshake = FALSE<br><strong>character-set-server = utf8</strong><br>collation-server = utf8_unicode_ci<br>init_connect=’SET NAMES utf8’</p>\n</blockquote>\n<p>3、修改my.ini文件后，保存，再重启mysql服务。计算机——右键——管理——服务，找到mysql57，对其右键停止，再启动即可</p>\n<p>4、打开终端，登陆mysql后再查看字符集：show variables like ‘character%’; 此时更改字符集成功。</p>\n<h3 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h3><p>修改mysql字符集<br>查看字符集 show variables like ‘%character%’;</p>\n<p>主要关注character_set_server的字符集 默认为latin1不支持中文，需要修改为utf8</p>\n<blockquote>\n<p>vim /etc/my.cnf</p>\n</blockquote>\n<p>1、在[client]字段里加入default-character-set=utf8，如下：</p>\n<blockquote>\n<p>[client]<br>port = 3306<br>socket = /var/lib/mysql/mysql.sock<br>default-character-set=utf8</p>\n</blockquote>\n<p>2、在[mysqld]字段里加入character-set-server=utf8，（注意KEY不要写错，网上很多文章都是写default-character-set是错的）如下：</p>\n<blockquote>\n<p>[mysqld]<br>port = 3306<br>socket = /var/lib/mysql/mysql.sock<br>character-set-server=utf8</p>\n</blockquote>\n<p>3、在[mysql]字段里加入default-character-set=utf8，如下：</p>\n<blockquote>\n<p>[mysql]<br>no-auto-rehash<br>default-character-set=utf8</p>\n</blockquote>\n<p>完成后重启 service mysql restart</p>\n","more":"<h2 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h2><p>微信用户昵称问题存在特殊字符时，无法保存。因为utf8只能保存三个字节，但是微信表情很多都是四个字节，故无法保存。</p>\n<h2 id=\"解决方式\"><a href=\"#解决方式\" class=\"headerlink\" title=\"解决方式\"></a>解决方式</h2><p>将微信字符集由utf8 设置为 utf8mb4</p>\n<h2 id=\"mysql字符集设置\"><a href=\"#mysql字符集设置\" class=\"headerlink\" title=\"mysql字符集设置\"></a>mysql字符集设置</h2><h3 id=\"window\"><a href=\"#window\" class=\"headerlink\" title=\"window\"></a>window</h3><p>此处设置字符集与数据库安装路径不同，注意区别</p>\n<h4 id=\"MySQL5-7修改字符集\"><a href=\"#MySQL5-7修改字符集\" class=\"headerlink\" title=\"MySQL5.7修改字符集\"></a>MySQL5.7修改字符集</h4><p>本人安装的mysql版本是5.7.20，安装好mysql后就要对字符集进行修改了，于是照着网上的大部分教程说的去安装目录找一个my-default.ini文件，然后重命名为my.ini，再对其进修改字符集即可，具体如下：</p>\n<p>1、mysql5.7.20的my.ini文件不在安装目录下，如果你是默认安装mysql的，那么它的my.ini文件在隐藏文件夹C:\\ProgramData\\MySQL\\MySQL Server 5.7下</p>\n<p>2、对my.ini文件进行修改，修改前请备份好一份。</p>\n<blockquote>\n<p>在该my.ini文件下进行配置修改 ：</p>\n<p>[client]<br>default-character-set = utf8</p>\n<p>[mysql]<br><strong>default-character-set = utf8</strong></p>\n<p>[mysqld]<br>character-set-client-handshake = FALSE<br><strong>character-set-server = utf8</strong><br>collation-server = utf8_unicode_ci<br>init_connect=’SET NAMES utf8’</p>\n</blockquote>\n<p>3、修改my.ini文件后，保存，再重启mysql服务。计算机——右键——管理——服务，找到mysql57，对其右键停止，再启动即可</p>\n<p>4、打开终端，登陆mysql后再查看字符集：show variables like ‘character%’; 此时更改字符集成功。</p>\n<h3 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h3><p>修改mysql字符集<br>查看字符集 show variables like ‘%character%’;</p>\n<p>主要关注character_set_server的字符集 默认为latin1不支持中文，需要修改为utf8</p>\n<blockquote>\n<p>vim /etc/my.cnf</p>\n</blockquote>\n<p>1、在[client]字段里加入default-character-set=utf8，如下：</p>\n<blockquote>\n<p>[client]<br>port = 3306<br>socket = /var/lib/mysql/mysql.sock<br>default-character-set=utf8</p>\n</blockquote>\n<p>2、在[mysqld]字段里加入character-set-server=utf8，（注意KEY不要写错，网上很多文章都是写default-character-set是错的）如下：</p>\n<blockquote>\n<p>[mysqld]<br>port = 3306<br>socket = /var/lib/mysql/mysql.sock<br>character-set-server=utf8</p>\n</blockquote>\n<p>3、在[mysql]字段里加入default-character-set=utf8，如下：</p>\n<blockquote>\n<p>[mysql]<br>no-auto-rehash<br>default-character-set=utf8</p>\n</blockquote>\n<p>完成后重启 service mysql restart</p>\n","next":{"title":"BIO-NIO-AIO 模型","path":"api/articles/resource-java-Netty-IOModule-BIO-NIO-AIO.json","image":"/img/header_img/15.gif","num_read":632,"num_like":947,"num_collection":541,"num_comments":106},"prev":{"title":"Maven私服:Docker安装nexus3","path":"api/articles/resource-RPC-Docker-Centos-Docker-nexus.json","image":"/img/header_img/docker/docker.jpg","num_read":70,"num_like":920,"num_collection":301,"num_comments":79},"categories":[{"name":"数据库","path":"api/categories/数据库.json","pathContent":"api/categories/数据库","description":"结构化存储格式+事务和并发控制+内存管理+SQL访问接口","cover":"https://sunfy9.gitee.io/project/photo/project/db.jpg"}],"tags":[{"name":"MySQL","path":"api/tags/MySQL.json","pathContent":"api/tags/MySQL","description":"一种关系型数据库管理系统","cover":"https://sunfy9.gitee.io/project/photo/project/desk.jpg"}]}