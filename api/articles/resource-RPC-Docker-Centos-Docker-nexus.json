{"title":"Maven私服:Docker安装nexus3","num_read":1506,"num_like":214,"num_collection":248,"num_comments":150,"slug":"resource-RPC-Docker-Centos-Docker-nexus","date":"2020-12-14T16:00:00.000Z","img":"/img/header_img/docker/docker.jpg","_id":"clhrbp2fo00ezo5lght619jic","project":"RPC","site":{"data":{}},"updated":"2022-09-20T02:07:23.647Z","author":"Sunfy","comments":true,"path":"api/articles/resource-RPC-Docker-Centos-Docker-nexus.json","webPath":"2020/12/15/resource-RPC-Docker-Centos-Docker-nexus/","permalink":"https://sunfy9.gitee.io/2020/12/15/resource-RPC-Docker-Centos-Docker-nexus/","excerpt":"Maven私服:Docker安装nexus3","covers":["../../../../img/Centos-Docker-nexus/image-20210227141811676.png","../../../../img/Centos-Docker-nexus/image-20210227141828786.png","../../../../img/Centos-Docker-nexus/image-20210227141843661.png","../../../../img/Centos-Docker-nexus/image-20210227141857274.png","../../../../img/Centos-Docker-nexus/image-20210227141910506.png","../../../../img/Centos-Docker-nexus/image-20210227141924143.png","../../../../img/Centos-Docker-nexus/image-20210227141936385.png","../../../../img/Centos-Docker-nexus/image-20210227141952818.png","../../../../img/Centos-Docker-nexus/image-20210227142011753.png","../../../../img/Centos-Docker-nexus/image-20210227142027853.png","../../../../img/Centos-Docker-nexus/image-20210227142050650.png","../../../../img/Centos-Docker-nexus/image-20210227142106796.png","../../../../img/Centos-Docker-nexus/2019071715413379.png"],"keywords":"sunfy, hexo-theme-snail","content":"<p>Maven私服:Docker安装nexus3<a id=\"more\"></a></p>\n<p>心血来潮，想自己搭个项目试试，锻炼下架构相关的东东。其中的一步就是搭建maven私服，方便自己部署私包。</p>\n<h3 id=\"查找nexus3镜像\"><a href=\"#查找nexus3镜像\" class=\"headerlink\" title=\"查找nexus3镜像\"></a>查找nexus3镜像</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker search nexus3</span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141811676.png\" alt=\"image-20210227141811676\"></p>\n<h3 id=\"拉取nexus3镜像\"><a href=\"#拉取nexus3镜像\" class=\"headerlink\" title=\"拉取nexus3镜像\"></a>拉取nexus3镜像</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull docker.io&#x2F;sonatype&#x2F;nexus3</span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141828786.png\" alt=\"image-20210227141828786\"></p>\n<h3 id=\"查看镜像\"><a href=\"#查看镜像\" class=\"headerlink\" title=\"查看镜像\"></a>查看镜像<sunfy-line></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images</span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141843661.png\" alt=\"image-20210227141843661\"></p>\n<h3 id=\"启动容器\"><a href=\"#启动容器\" class=\"headerlink\" title=\"启动容器\"></a>启动容器</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -tid -p 8081:8081 --privileged=true --name nexus3 -v $PWD/nexus-data:/var/nexus-data --restart=always docker.io/sonatype/nexus3</span><br></pre></td></tr></table></figure>\n<p>-tid  ：创建守护式容器 。</p>\n<p>-p 8081:8081 ：宿主机端口（对外访问端口）：容器映射端口。<br>               这2个端口可不一样。浏览器访问URL用前面个端口 。</p>\n<p>—privileged=true ：容器访问宿主机的多级目录时可能会权限不足，故给 root 权限 。</p>\n<p>—name nexus3 ：给容器取名，可任意设定。</p>\n<p>-v $PWD/nexus-data:/var/nexus-data ：<br>    把容器中的 nexus-data 目录挂载到宿主机当前路径下的 nexus-data 下。<br>    方便以后查看相关数据。<br>    $PWD ：取当前路径。此处可以写死为某个完整的确定的目录。<br>    挂载格式为： -v  宿主机目录 ：容器目录 。  </p>\n<p>—restart=always ：服务挂后，自动重启 。</p>\n<p>docker.io/sonatype/nexus3 ：镜像名 。</p>\n<h3 id=\"启动容器2\"><a href=\"#启动容器2\" class=\"headerlink\" title=\"启动容器2\"></a>启动容器2</h3><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -id --privileged=<span class=\"literal\">true</span> --name=nexus3 --restart=always -p <span class=\"number\">8081</span>:<span class=\"number\">8081</span> -v /kichun/nexus3/nexus-<span class=\"keyword\">data</span>:/<span class=\"keyword\">var</span>/nexus-<span class=\"keyword\">data</span> <span class=\"number\">6e9721</span>ad473a（这个是容器id或名称）</span><br></pre></td></tr></table></figure>\n<p>解释：<br> -id 创建守护式容器<br> —privileged=true 授予root权限（挂载多级目录必须为true，否则容器访问宿主机权限不足）<br> —name=名字  给你的容器起个名字<br> -p 宿主机端口：容器端口映射<br> -v 宿主机目录：容器目录 目录挂载</p>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141857274.png\" alt=\"image-20210227141857274\"></p>\n<p>注意：<br> 运行容器后访问主机+配置的宿主机映射端口无反应时，请稍等几分钟（视配置时间长短不一），等待nexus3完成初始化才能访问成功</p>\n<h3 id=\"访问nexus3\"><a href=\"#访问nexus3\" class=\"headerlink\" title=\"访问nexus3\"></a>访问nexus3</h3><p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141910506.png\" alt=\"image-20210227141910506\"></p>\n<h3 id=\"登录\"><a href=\"#登录\" class=\"headerlink\" title=\"登录\"></a>登录</h3><p>默认admin密码admin123</p>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141924143.png\" alt=\"image-20210227141924143\"></p>\n<h3 id=\"查看仓库\"><a href=\"#查看仓库\" class=\"headerlink\" title=\"查看仓库\"></a>查看仓库</h3><p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141936385.png\" alt=\"image-20210227141936385\"></p>\n<h3 id=\"在项目中配置私服\"><a href=\"#在项目中配置私服\" class=\"headerlink\" title=\"在项目中配置私服\"></a>在项目中配置私服</h3><p>拷贝public仓库地址</p>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141952818.png\" alt=\"image-20210227141952818\"></p>\n<p>配置到你本地maven的settings文件<br> 注意：是public group仓库地址而不是releases或snapshots仓库，public默认包含了这两个仓库</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">profiles</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">profile</span>&gt;</span>  </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>dev<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span>  </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">repositories</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">repository</span>&gt;</span>  </span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>local-nexus<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://192.168.3.128:8081/repository/maven-public/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span>  </span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">releases</span>&gt;</span>  </span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">enabled</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">enabled</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;/<span class=\"name\">releases</span>&gt;</span>  </span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">snapshots</span>&gt;</span>  </span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">enabled</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">enabled</span>&gt;</span>  </span><br><span class=\"line\">       <span class=\"tag\">&lt;/<span class=\"name\">snapshots</span>&gt;</span>  </span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">repository</span>&gt;</span> </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">repositories</span>&gt;</span>  </span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">profile</span>&gt;</span>  </span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">profiles</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">activeProfiles</span>&gt;</span>  </span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">activeProfile</span>&gt;</span>dev<span class=\"tag\">&lt;/<span class=\"name\">activeProfile</span>&gt;</span>  </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">activeProfiles</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227142011753.png\" alt=\"image-20210227142011753\"></p>\n<p>配置maven settings文件的服务器用户名密码<br> 注意：id为私服中releases和snapshots仓库名，必须一致</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- servers</span></span><br><span class=\"line\"><span class=\"comment\"> | This is a list of authentication profiles, keyed by the server-id used within the system.</span></span><br><span class=\"line\"><span class=\"comment\"> | Authentication profiles can be used whenever maven must make a connection to a remote server.</span></span><br><span class=\"line\"><span class=\"comment\"> |--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servers</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">server</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>maven-releases<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">username</span>&gt;</span>admin<span class=\"tag\">&lt;/<span class=\"name\">username</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>admin123<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">server</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">server</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>maven-snapshots<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">username</span>&gt;</span>admin<span class=\"tag\">&lt;/<span class=\"name\">username</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>admin123<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">server</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servers</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227142027853.png\" alt=\"image-20210227142027853\"></p>\n<p>在项目父pom文件中配置部署环境，注意id及URL必须与nexus仓库对应</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--私服仓库--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">distributionManagement</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">repository</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>maven-releases<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Nexus Release Repository<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://192.168.3.128:8081/repository/maven-releases/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">repository</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">snapshotRepository</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>maven-snapshots<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Nexus Snapshot Repository<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://192.168.3.128:8081/repository/maven-snapshots/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">snapshotRepository</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">distributionManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227142050650.png\" alt=\"image-20210227142050650\"></p>\n<p>重新打开项目，对需要的模块进行deploy</p>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227142106796.png\" alt=\"image-20210227142106796\"></p>\n<p>在nexus中查看上传的jar</p>\n<p>PS：</p>\n<p>遇到问题1：</p>\n<p>在启动容器时我原本想换个端口，但发现不用 8081 时，tcp 的端口映射也是自动设置为 8081 的。并且换了端口后，虽然能启动容器成功，显示为运行状态，但是浏览器始终访问不到服务，报错：拒绝连接。最后还是使用了 8081 端口。</p>\n<p>遇到问题2：</p>\n<p>登陆时始终报错，账号或密码不对，默认密码并不是 admin123。</p>\n<p>对此解决方法见文章： ( Docker 方式运行 Nexus3 登陆密码不为 admin123 、重置登陆密码) </p>\n<p>遇到问题3：</p>\n<p>容器内部的时间比服务器时间晚 8 小时。</p>\n<p>解决方法：启动容器时 加入参数：  -v /etc/localtime:/etc/localtime:ro 。ro：只读。</p>\n<p>完整启动命令为：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -tid -p 8081:8081 --privileged=true --name nexus3 -v $PWD/nexus-data:/var/nexus-data  -v /etc/localtime:/etc/localtime:ro --restart=always docker.io/sonatype/nexus3</span><br></pre></td></tr></table></figure>\n<p>遇到问题4：</p>\n<p>执行 mvn  deploy 命令报错：</p>\n<p><img src=\"../../../../img/Centos-Docker-nexus/2019071715413379.png\" alt=\"img\"></p>\n","more":"</p>\n<p>心血来潮，想自己搭个项目试试，锻炼下架构相关的东东。其中的一步就是搭建maven私服，方便自己部署私包。</p>\n<h3 id=\"查找nexus3镜像\"><a href=\"#查找nexus3镜像\" class=\"headerlink\" title=\"查找nexus3镜像\"></a>查找nexus3镜像</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker search nexus3</span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141811676.png\" alt=\"image-20210227141811676\"></p>\n<h3 id=\"拉取nexus3镜像\"><a href=\"#拉取nexus3镜像\" class=\"headerlink\" title=\"拉取nexus3镜像\"></a>拉取nexus3镜像</h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull docker.io&#x2F;sonatype&#x2F;nexus3</span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141828786.png\" alt=\"image-20210227141828786\"></p>\n<h3 id=\"查看镜像\"><a href=\"#查看镜像\" class=\"headerlink\" title=\"查看镜像\"></a>查看镜像<sunfy-line></h3><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker images</span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141843661.png\" alt=\"image-20210227141843661\"></p>\n<h3 id=\"启动容器\"><a href=\"#启动容器\" class=\"headerlink\" title=\"启动容器\"></a>启动容器</h3><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -tid -p 8081:8081 --privileged=true --name nexus3 -v $PWD/nexus-data:/var/nexus-data --restart=always docker.io/sonatype/nexus3</span><br></pre></td></tr></table></figure>\n<p>-tid  ：创建守护式容器 。</p>\n<p>-p 8081:8081 ：宿主机端口（对外访问端口）：容器映射端口。<br>               这2个端口可不一样。浏览器访问URL用前面个端口 。</p>\n<p>—privileged=true ：容器访问宿主机的多级目录时可能会权限不足，故给 root 权限 。</p>\n<p>—name nexus3 ：给容器取名，可任意设定。</p>\n<p>-v $PWD/nexus-data:/var/nexus-data ：<br>    把容器中的 nexus-data 目录挂载到宿主机当前路径下的 nexus-data 下。<br>    方便以后查看相关数据。<br>    $PWD ：取当前路径。此处可以写死为某个完整的确定的目录。<br>    挂载格式为： -v  宿主机目录 ：容器目录 。  </p>\n<p>—restart=always ：服务挂后，自动重启 。</p>\n<p>docker.io/sonatype/nexus3 ：镜像名 。</p>\n<h3 id=\"启动容器2\"><a href=\"#启动容器2\" class=\"headerlink\" title=\"启动容器2\"></a>启动容器2</h3><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -id --privileged=<span class=\"literal\">true</span> --name=nexus3 --restart=always -p <span class=\"number\">8081</span>:<span class=\"number\">8081</span> -v /kichun/nexus3/nexus-<span class=\"keyword\">data</span>:/<span class=\"keyword\">var</span>/nexus-<span class=\"keyword\">data</span> <span class=\"number\">6e9721</span>ad473a（这个是容器id或名称）</span><br></pre></td></tr></table></figure>\n<p>解释：<br> -id 创建守护式容器<br> —privileged=true 授予root权限（挂载多级目录必须为true，否则容器访问宿主机权限不足）<br> —name=名字  给你的容器起个名字<br> -p 宿主机端口：容器端口映射<br> -v 宿主机目录：容器目录 目录挂载</p>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141857274.png\" alt=\"image-20210227141857274\"></p>\n<p>注意：<br> 运行容器后访问主机+配置的宿主机映射端口无反应时，请稍等几分钟（视配置时间长短不一），等待nexus3完成初始化才能访问成功</p>\n<h3 id=\"访问nexus3\"><a href=\"#访问nexus3\" class=\"headerlink\" title=\"访问nexus3\"></a>访问nexus3</h3><p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141910506.png\" alt=\"image-20210227141910506\"></p>\n<h3 id=\"登录\"><a href=\"#登录\" class=\"headerlink\" title=\"登录\"></a>登录</h3><p>默认admin密码admin123</p>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141924143.png\" alt=\"image-20210227141924143\"></p>\n<h3 id=\"查看仓库\"><a href=\"#查看仓库\" class=\"headerlink\" title=\"查看仓库\"></a>查看仓库</h3><p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141936385.png\" alt=\"image-20210227141936385\"></p>\n<h3 id=\"在项目中配置私服\"><a href=\"#在项目中配置私服\" class=\"headerlink\" title=\"在项目中配置私服\"></a>在项目中配置私服</h3><p>拷贝public仓库地址</p>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227141952818.png\" alt=\"image-20210227141952818\"></p>\n<p>配置到你本地maven的settings文件<br> 注意：是public group仓库地址而不是releases或snapshots仓库，public默认包含了这两个仓库</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">profiles</span>&gt;</span></span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">profile</span>&gt;</span>  </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>dev<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span>  </span><br><span class=\"line\">   <span class=\"tag\">&lt;<span class=\"name\">repositories</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">repository</span>&gt;</span>  </span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>local-nexus<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://192.168.3.128:8081/repository/maven-public/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span>  </span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">releases</span>&gt;</span>  </span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">enabled</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">enabled</span>&gt;</span></span><br><span class=\"line\">       <span class=\"tag\">&lt;/<span class=\"name\">releases</span>&gt;</span>  </span><br><span class=\"line\">       <span class=\"tag\">&lt;<span class=\"name\">snapshots</span>&gt;</span>  </span><br><span class=\"line\">         <span class=\"tag\">&lt;<span class=\"name\">enabled</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">enabled</span>&gt;</span>  </span><br><span class=\"line\">       <span class=\"tag\">&lt;/<span class=\"name\">snapshots</span>&gt;</span>  </span><br><span class=\"line\">     <span class=\"tag\">&lt;/<span class=\"name\">repository</span>&gt;</span> </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">repositories</span>&gt;</span>  </span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">profile</span>&gt;</span>  </span><br><span class=\"line\"> <span class=\"tag\">&lt;/<span class=\"name\">profiles</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"> <span class=\"tag\">&lt;<span class=\"name\">activeProfiles</span>&gt;</span>  </span><br><span class=\"line\">     <span class=\"tag\">&lt;<span class=\"name\">activeProfile</span>&gt;</span>dev<span class=\"tag\">&lt;/<span class=\"name\">activeProfile</span>&gt;</span>  </span><br><span class=\"line\">   <span class=\"tag\">&lt;/<span class=\"name\">activeProfiles</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227142011753.png\" alt=\"image-20210227142011753\"></p>\n<p>配置maven settings文件的服务器用户名密码<br> 注意：id为私服中releases和snapshots仓库名，必须一致</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- servers</span></span><br><span class=\"line\"><span class=\"comment\"> | This is a list of authentication profiles, keyed by the server-id used within the system.</span></span><br><span class=\"line\"><span class=\"comment\"> | Authentication profiles can be used whenever maven must make a connection to a remote server.</span></span><br><span class=\"line\"><span class=\"comment\"> |--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">servers</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">server</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>maven-releases<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">username</span>&gt;</span>admin<span class=\"tag\">&lt;/<span class=\"name\">username</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>admin123<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">server</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">server</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>maven-snapshots<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">username</span>&gt;</span>admin<span class=\"tag\">&lt;/<span class=\"name\">username</span>&gt;</span>  </span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>admin123<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span>  </span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">server</span>&gt;</span> </span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">servers</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227142027853.png\" alt=\"image-20210227142027853\"></p>\n<p>在项目父pom文件中配置部署环境，注意id及URL必须与nexus仓库对应</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!--私服仓库--&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">distributionManagement</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">repository</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>maven-releases<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Nexus Release Repository<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://192.168.3.128:8081/repository/maven-releases/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">repository</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">snapshotRepository</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">id</span>&gt;</span>maven-snapshots<span class=\"tag\">&lt;/<span class=\"name\">id</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>Nexus Snapshot Repository<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">url</span>&gt;</span>http://192.168.3.128:8081/repository/maven-snapshots/<span class=\"tag\">&lt;/<span class=\"name\">url</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">snapshotRepository</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">distributionManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227142050650.png\" alt=\"image-20210227142050650\"></p>\n<p>重新打开项目，对需要的模块进行deploy</p>\n<p><img src=\"../../../../img/Centos-Docker-nexus/image-20210227142106796.png\" alt=\"image-20210227142106796\"></p>\n<p>在nexus中查看上传的jar</p>\n<p>PS：</p>\n<p>遇到问题1：</p>\n<p>在启动容器时我原本想换个端口，但发现不用 8081 时，tcp 的端口映射也是自动设置为 8081 的。并且换了端口后，虽然能启动容器成功，显示为运行状态，但是浏览器始终访问不到服务，报错：拒绝连接。最后还是使用了 8081 端口。</p>\n<p>遇到问题2：</p>\n<p>登陆时始终报错，账号或密码不对，默认密码并不是 admin123。</p>\n<p>对此解决方法见文章： ( Docker 方式运行 Nexus3 登陆密码不为 admin123 、重置登陆密码) </p>\n<p>遇到问题3：</p>\n<p>容器内部的时间比服务器时间晚 8 小时。</p>\n<p>解决方法：启动容器时 加入参数：  -v /etc/localtime:/etc/localtime:ro 。ro：只读。</p>\n<p>完整启动命令为：</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker run -tid -p 8081:8081 --privileged=true --name nexus3 -v $PWD/nexus-data:/var/nexus-data  -v /etc/localtime:/etc/localtime:ro --restart=always docker.io/sonatype/nexus3</span><br></pre></td></tr></table></figure>\n<p>遇到问题4：</p>\n<p>执行 mvn  deploy 命令报错：</p>\n<p><img src=\"../../../../img/Centos-Docker-nexus/2019071715413379.png\" alt=\"img\"></p>","next":{"title":"MySQL微信表情包特殊字符问题","path":"api/articles/resource-DB-MySQL-MySQl-wechat.json","image":"/img/header_img/DB/wechat.png","num_read":1793,"num_like":336,"num_collection":136,"num_comments":171},"prev":{"title":"docker下gitlab安装配置使用","path":"api/articles/resource-RPC-Docker-docker下gitlab安装配置使用.json","image":"/img/header_img/docker/docker.gif","num_read":346,"num_like":457,"num_collection":511,"num_comments":164},"categories":[{"name":"RPC远程调用","path":"api/categories/RPC远程调用.json","pathContent":"api/categories/RPC远程调用","description":"RPC（Remote Procedure Call）远程过程调用，简单的理解是一个节点请求另一个节点提供的服务","cover":"https://sunfy9.gitee.io/project/photo/project/rpc.jpg"}],"tags":[{"name":"CentOS","path":"api/tags/CentOS.json","pathContent":"api/tags/CentOS","description":"免费的、开源的、可以重新分发的开源操作系统","cover":"https://sunfy9.gitee.io/img/header_img/windows/centos.png"},{"name":"Docker","path":"api/tags/Docker.json","pathContent":"api/tags/Docker","description":"一个开源的应用容器引擎。","cover":"https://sunfy9.gitee.io/img/header_img/sunfy-default.png"},{"name":"nexus3","path":"api/tags/nexus3.json","pathContent":"api/tags/nexus3","description":"[nexus3]暂未设置说明","cover":"https://sunfy9.gitee.io/img/header_img/sunfy-default.png"}]}