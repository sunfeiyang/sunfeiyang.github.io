{"title":"uniapp(微信小程序) markdown最佳渲染方案","num_read":696,"num_like":193,"num_collection":848,"num_comments":134,"slug":"resource-desk-vue-uniapp-微信小程序-markdown最佳渲染方案","date":"2021-09-17T16:00:00.000Z","img":"/img/header_img/desk/uniapp.png","_id":"clhrbp2d5006ao5lg9ga97g4j","project":"desk","subtitle":"markdown最佳渲染方案","site":{"data":{}},"updated":"2022-09-20T01:39:11.750Z","author":"Sunfy","comments":true,"path":"api/articles/resource-desk-vue-uniapp-微信小程序-markdown最佳渲染方案.json","webPath":"2021/09/18/resource-desk-vue-uniapp-微信小程序-markdown最佳渲染方案/","permalink":"https://sunfy9.gitee.io/2021/09/18/resource-desk-vue-uniapp-%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F-markdown%E6%9C%80%E4%BD%B3%E6%B8%B2%E6%9F%93%E6%96%B9%E6%A1%88/","excerpt":null,"covers":["../../../../img/uniapp(微信小程序","../../../../img/uniapp(微信小程序","../../../../img/uniapp(微信小程序","../../../../img/uniapp(微信小程序"],"keywords":"sunfy, hexo-theme-snail","content":"<h1 id=\"markdown最佳渲染方案\"><a href=\"#markdown最佳渲染方案\" class=\"headerlink\" title=\"markdown最佳渲染方案\"></a>markdown最佳渲染方案</h1><p>　　尝试了<code>rich-text</code>、<code>uparse</code>、<code>v-html</code>等渲染方案，总感觉差点意思，没有达到自己真正想要的效果，今天终于找到一个完美的解决方案，如果还有什么欠缺就自行优化咯。</p>\n<blockquote>\n<p>​    <strong>Towxml</strong> 是一个可将<code>HTML</code>、<code>Markdown</code>转为微信小程序<code>WXML</code>(WeiXin Markup Language)的渲染库。用于解决在微信小程序中<code>Markdown</code>、<code>HTML</code>不能直接渲染的问题。</p>\n</blockquote>\n<p><a href=\"https://github.com/sbfkcel/towxml\" target=\"_blank\" rel=\"noopener\">官方文档</a></p>\n<p><img src=\"../../../../img/uniapp(微信小程序\" alt=\"image-20211014174114953\"> markdown最佳渲染方案/image-20211014174114953.png)</p>\n<p><img src=\"../../../../img/uniapp(微信小程序\" alt=\"image-20211014174125557\"> markdown最佳渲染方案/image-20211014174125557.png)</p>\n<p>从官网上介绍来看，支持的功能还是相对比较全的。</p>\n<h1 id=\"uniapp使用流程\"><a href=\"#uniapp使用流程\" class=\"headerlink\" title=\"uniapp使用流程\"></a>uniapp使用流程</h1><ul>\n<li><p>新建个空目录，git clone <a href=\"https://github.com/sbfkcel/towxml.git\" target=\"_blank\" rel=\"noopener\">https://github.com/sbfkcel/towxml.git</a></p>\n</li>\n<li><p>在下载的文件目录下安装所需依赖 npm install</p>\n</li>\n<li><p>构建项目 npm run build</p>\n</li>\n<li><p>修改dist文件夹下decode.json为下，此处配置各个元素采用的解析方式，后面可以根据配置的路径对不满意的功能进行优化<sunfy-line></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"attr\">\"component\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">\t<span class=\"attr\">\"usingComponents\"</span>: &#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">\"decode\"</span>: <span class=\"string\">\"../towxml/decode\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"audio-player\"</span>: <span class=\"string\">\"../towxml/audio-player/audio-player\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"latex\"</span>: <span class=\"string\">\"../towxml/latex/latex\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"table\"</span>: <span class=\"string\">\"../towxml/table/table\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"todogroup\"</span>: <span class=\"string\">\"../towxml/todogroup/todogroup\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"yuml\"</span>: <span class=\"string\">\"../towxml/yuml/yuml\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"img\"</span>: <span class=\"string\">\"../towxml/img/img\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>将修改过的dist文件夹复制到uniapp工程的static目录下，并修改名字为towxml</p>\n<p><img src=\"../../../../img/uniapp(微信小程序\" alt=\"image-20211014174505817\"> markdown最佳渲染方案/image-20211014174505817.png)</p>\n</li>\n</ul>\n<h1 id=\"组件中使用\"><a href=\"#组件中使用\" class=\"headerlink\" title=\"组件中使用\"></a>组件中使用</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t&lt;view&gt;</span><br><span class=\"line\">\t\t&lt;towxml :nodes&#x3D;&quot;postContent&quot;&#x2F;&gt;</span><br><span class=\"line\">\t&lt;&#x2F;view&gt;</span><br><span class=\"line\">&lt;&#x2F;template&gt;</span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">\timport towxml from &#39;@&#x2F;static&#x2F;towxml&#x2F;towxml&#39;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\texport default &#123;</span><br><span class=\"line\">\t\tcomponents: &#123;</span><br><span class=\"line\">\t\t\ttowxml</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\tdata() &#123;</span><br><span class=\"line\">\t\t\treturn &#123;</span><br><span class=\"line\">  \t\t\t  \ttowxmlFunc:require(&#39;@&#x2F;static&#x2F;towxml&#x2F;index.js&#39;),</span><br><span class=\"line\">\t\t\t\tpostContent:&#39;&#39;,</span><br><span class=\"line\">\t\t\t&#125;;</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\tonLoad(options) &#123;</span><br><span class=\"line\">\t\t    this.postContent &#x3D; &#39;要展示的内容&#39;</span><br><span class=\"line\">\t\t    this.postContent &#x3D; this.towxmlFunc(this.postContent,&#39;markdown&#39;)</span><br><span class=\"line\">\t    &#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>\n<p>效果图</p>\n<p><img src=\"../../../../img/uniapp(微信小程序\" alt=\"image-20211014174808491\"> markdown最佳渲染方案/image-20211014174808491.png)</p>\n<h1 id=\"功能优化\"><a href=\"#功能优化\" class=\"headerlink\" title=\"功能优化\"></a>功能优化</h1><p>完成上述配置后，页面展示都没问题，不过有一个体验不好的地方在图片。上述组件中图片点击并不能放大，导致用起来会比较蹩脚。</p>\n<p>接下来就对图片点击功能进行优化，其实也很简单，就是采用微信原生API对功能进行增强。具体优化如下：</p>\n<p>找到<code>img.wxml</code>文件，这个文件中就是一个<image>标签，在这个标签中增加单击事件<code>bindtap=&quot;clickImg&quot;</code>，在对应的<code>js</code>文件中条件函数如下</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 增加图片点击事件</span></span><br><span class=\"line\">clickImg() &#123;</span><br><span class=\"line\">    wx.previewImage(&#123;</span><br><span class=\"line\">        <span class=\"comment\">//需要预览的图片http链接列表，多张的时候，url直接写在后面就行了</span></span><br><span class=\"line\">        urls: [<span class=\"keyword\">this</span>.data.attrs.src], </span><br><span class=\"line\">        current: <span class=\"string\">''</span>, <span class=\"comment\">// 当前显示图片的http链接，默认是第一个</span></span><br><span class=\"line\">        success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">res</span>) </span>&#123;&#125;,</span><br><span class=\"line\">        fail: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">res</span>) </span>&#123;&#125;,</span><br><span class=\"line\">        complete: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">res</span>) </span>&#123;&#125;,</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<p>至此，功能就已经完成。</p>\n","more":"<h1 id=\"markdown最佳渲染方案\"><a href=\"#markdown最佳渲染方案\" class=\"headerlink\" title=\"markdown最佳渲染方案\"></a>markdown最佳渲染方案</h1><p>　　尝试了<code>rich-text</code>、<code>uparse</code>、<code>v-html</code>等渲染方案，总感觉差点意思，没有达到自己真正想要的效果，今天终于找到一个完美的解决方案，如果还有什么欠缺就自行优化咯。</p>\n<blockquote>\n<p>​    <strong>Towxml</strong> 是一个可将<code>HTML</code>、<code>Markdown</code>转为微信小程序<code>WXML</code>(WeiXin Markup Language)的渲染库。用于解决在微信小程序中<code>Markdown</code>、<code>HTML</code>不能直接渲染的问题。</p>\n</blockquote>\n<p><a href=\"https://github.com/sbfkcel/towxml\" target=\"_blank\" rel=\"noopener\">官方文档</a></p>\n<p><img src=\"../../../../img/uniapp(微信小程序\" alt=\"image-20211014174114953\"> markdown最佳渲染方案/image-20211014174114953.png)</p>\n<p><img src=\"../../../../img/uniapp(微信小程序\" alt=\"image-20211014174125557\"> markdown最佳渲染方案/image-20211014174125557.png)</p>\n<p>从官网上介绍来看，支持的功能还是相对比较全的。</p>\n<h1 id=\"uniapp使用流程\"><a href=\"#uniapp使用流程\" class=\"headerlink\" title=\"uniapp使用流程\"></a>uniapp使用流程</h1><ul>\n<li><p>新建个空目录，git clone <a href=\"https://github.com/sbfkcel/towxml.git\" target=\"_blank\" rel=\"noopener\">https://github.com/sbfkcel/towxml.git</a></p>\n</li>\n<li><p>在下载的文件目录下安装所需依赖 npm install</p>\n</li>\n<li><p>构建项目 npm run build</p>\n</li>\n<li><p>修改dist文件夹下decode.json为下，此处配置各个元素采用的解析方式，后面可以根据配置的路径对不满意的功能进行优化<sunfy-line></p>\n<figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"attr\">\"component\"</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">\t<span class=\"attr\">\"usingComponents\"</span>: &#123;</span><br><span class=\"line\">\t\t<span class=\"attr\">\"decode\"</span>: <span class=\"string\">\"../towxml/decode\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"audio-player\"</span>: <span class=\"string\">\"../towxml/audio-player/audio-player\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"latex\"</span>: <span class=\"string\">\"../towxml/latex/latex\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"table\"</span>: <span class=\"string\">\"../towxml/table/table\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"todogroup\"</span>: <span class=\"string\">\"../towxml/todogroup/todogroup\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"yuml\"</span>: <span class=\"string\">\"../towxml/yuml/yuml\"</span>,</span><br><span class=\"line\">\t\t<span class=\"attr\">\"img\"</span>: <span class=\"string\">\"../towxml/img/img\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>将修改过的dist文件夹复制到uniapp工程的static目录下，并修改名字为towxml</p>\n<p><img src=\"../../../../img/uniapp(微信小程序\" alt=\"image-20211014174505817\"> markdown最佳渲染方案/image-20211014174505817.png)</p>\n</li>\n</ul>\n<h1 id=\"组件中使用\"><a href=\"#组件中使用\" class=\"headerlink\" title=\"组件中使用\"></a>组件中使用</h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;template&gt;</span><br><span class=\"line\">\t&lt;view&gt;</span><br><span class=\"line\">\t\t&lt;towxml :nodes&#x3D;&quot;postContent&quot;&#x2F;&gt;</span><br><span class=\"line\">\t&lt;&#x2F;view&gt;</span><br><span class=\"line\">&lt;&#x2F;template&gt;</span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">\timport towxml from &#39;@&#x2F;static&#x2F;towxml&#x2F;towxml&#39;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\texport default &#123;</span><br><span class=\"line\">\t\tcomponents: &#123;</span><br><span class=\"line\">\t\t\ttowxml</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\tdata() &#123;</span><br><span class=\"line\">\t\t\treturn &#123;</span><br><span class=\"line\">  \t\t\t  \ttowxmlFunc:require(&#39;@&#x2F;static&#x2F;towxml&#x2F;index.js&#39;),</span><br><span class=\"line\">\t\t\t\tpostContent:&#39;&#39;,</span><br><span class=\"line\">\t\t\t&#125;;</span><br><span class=\"line\">\t\t&#125;,</span><br><span class=\"line\">\t\tonLoad(options) &#123;</span><br><span class=\"line\">\t\t    this.postContent &#x3D; &#39;要展示的内容&#39;</span><br><span class=\"line\">\t\t    this.postContent &#x3D; this.towxmlFunc(this.postContent,&#39;markdown&#39;)</span><br><span class=\"line\">\t    &#125;,</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>\n<p>效果图</p>\n<p><img src=\"../../../../img/uniapp(微信小程序\" alt=\"image-20211014174808491\"> markdown最佳渲染方案/image-20211014174808491.png)</p>\n<h1 id=\"功能优化\"><a href=\"#功能优化\" class=\"headerlink\" title=\"功能优化\"></a>功能优化</h1><p>完成上述配置后，页面展示都没问题，不过有一个体验不好的地方在图片。上述组件中图片点击并不能放大，导致用起来会比较蹩脚。</p>\n<p>接下来就对图片点击功能进行优化，其实也很简单，就是采用微信原生API对功能进行增强。具体优化如下：</p>\n<p>找到<code>img.wxml</code>文件，这个文件中就是一个<image>标签，在这个标签中增加单击事件<code>bindtap=&quot;clickImg&quot;</code>，在对应的<code>js</code>文件中条件函数如下</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 增加图片点击事件</span></span><br><span class=\"line\">clickImg() &#123;</span><br><span class=\"line\">    wx.previewImage(&#123;</span><br><span class=\"line\">        <span class=\"comment\">//需要预览的图片http链接列表，多张的时候，url直接写在后面就行了</span></span><br><span class=\"line\">        urls: [<span class=\"keyword\">this</span>.data.attrs.src], </span><br><span class=\"line\">        current: <span class=\"string\">''</span>, <span class=\"comment\">// 当前显示图片的http链接，默认是第一个</span></span><br><span class=\"line\">        success: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">res</span>) </span>&#123;&#125;,</span><br><span class=\"line\">        fail: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">res</span>) </span>&#123;&#125;,</span><br><span class=\"line\">        complete: <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">res</span>) </span>&#123;&#125;,</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n<p>至此，功能就已经完成。</p>\n","next":{"title":"Java安全管理器入门","path":"api/articles/resource-java-Base-securityManager.json","image":"/img/header_img/java/securityManager.png","num_read":252,"num_like":565,"num_collection":397,"num_comments":172},"prev":{"title":"Java位运算符及相关问题","path":"api/articles/resource-java-Base-AnOperation.json","image":"/img/header_img/java/AnOperation.png","num_read":1757,"num_like":910,"num_collection":668,"num_comments":172},"categories":[{"name":"前端","path":"api/categories/前端.json","pathContent":"api/categories/前端","description":"包含vue、npm、html、Angular、js等相关","cover":"https://sunfy9.gitee.io/project/photo/project/desk.jpg"}],"tags":[{"name":"vue","path":"api/tags/vue.json","pathContent":"api/tags/vue","description":"[vue]暂未设置说明","cover":"https://sunfy9.gitee.io/img/header_img/sunfy-default.png"},{"name":"uniapp","path":"api/tags/uniapp.json","pathContent":"api/tags/uniapp","description":"[uniapp]暂未设置说明","cover":"https://sunfy9.gitee.io/img/header_img/sunfy-default.png"}]}